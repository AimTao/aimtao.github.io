(()=>{var e=jQuery("#modalSearch"),s="#local-search-input",a="#local-search-result";e.on("show.bs.modal",function(){var e=CONFIG.search_path||"/local-search.xml",t=a,r=jQuery(s),l=jQuery(t);if(0===r.length)throw Error("No element selected by the searchSelector");if(0===l.length)throw Error("No element selected by the resultSelector");-1===l.attr("class").indexOf("list-group-item")&&l.html('<div class="m-auto text-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div><br/>Loading...</div>'),jQuery.ajax({url:e,dataType:"xml",success:function(e){var t=jQuery("entry",e).map(function(){return{title:jQuery("title",this).text(),content:jQuery("content",this).text(),url:jQuery("url",this).text()}}).get();-1===l.html().indexOf("list-group-item")&&l.html(""),r.on("input",function(){var e=r.val(),h="",u=e.trim().toLowerCase().split(/[\s-]+/);return l.html(""),e.trim().length<=0?r.removeClass("invalid").removeClass("valid"):(t.forEach(function(e){var r,l,s=!0,t=(e.title&&""!==e.title.trim()||(e.title="Untitled"),e.title.trim()),a=t.toLowerCase(),i=e.content.trim().replace(/<[^>]+>/g,""),o=i.toLowerCase(),e=e.url,n=-1,c=-1;""!==o?u.forEach(function(e,t){r=a.indexOf(e),n=o.indexOf(e),r<0&&n<0?s=!1:(n<0&&(n=0),0===t&&(c=n))}):s=!1,s&&(h+="<a href='"+e+"' class='list-group-item list-group-item-action font-weight-bolder search-list-title'>"+t+"</a>",e=i,0<=c)&&(t=c+80,(t=0===(i=(i=c-20)<0?0:i)?100:t)>e.length&&(t=e.length),l=e.substring(i,t),u.forEach(function(e){var t=new RegExp(e,"gi");l=l.replace(t,'<span class="search-word">'+e+"</span>")}),h+="<p class='search-list-content'>"+l+"...</p>")}),-1===h.indexOf("list-group-item")?r.addClass("invalid").removeClass("valid"):(r.addClass("valid").removeClass("invalid"),void l.html(h)))})}})}),e.on("shown.bs.modal",function(){jQuery("#local-search-input").focus()}),e.on("hidden.bs.modal",function(){var e=s,t=a;if(e=jQuery(e),t=jQuery(t),0===e.length)throw Error("No element selected by the searchSelector");if(0===t.length)throw Error("No element selected by the resultSelector");e.val("").removeClass("invalid").removeClass("valid"),t.html("")})})();