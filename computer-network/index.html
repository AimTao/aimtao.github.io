<!DOCTYPE html><html lang="en" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" sizes="76x76" href="https://hutu0.aimtao.net/site/icon.webp"><link rel="icon" href="https://hutu0.aimtao.net/site/icon.webp"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="AimTao"><meta name="keywords" content="C++,Python,Go,算法，开发,blog,后端,记录"><meta name="description" content="本文以 OSI 七层模型为脉络，系统描述计算机网络协议及其作用、特点。"><title>学习笔记｜计算机网络 - AimTao</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_2113603_2ltiep6fmf8.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/lxgwwenkai-regular.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"www.aimtao.net",root:"/",version:"1.9.1",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:"❡"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"sh"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h2,h3,h4",collapseDepth:2},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!0,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:"07fe5d228ae82eadee00480515f9d64b",google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"hkFccy0TBvlTMrTD2n9MwSIx-gzGzoHsz",app_key:"yUJSgy6kcnRscdGX9ec7jlFz",server_url:"https://analytics.aimtao.net",path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><style type="text/css">.spoiler{display:inline}p.spoiler{display:flex}.spoiler a{pointer-events:none}.spoiler-blur,.spoiler-blur>*{transition:text-shadow .5s ease}.spoiler .spoiler-blur,.spoiler .spoiler-blur>*{color:transparent;background-color:rgba(0,0,0,0);text-shadow:0 0 10px grey;cursor:pointer}.spoiler .spoiler-blur:hover,.spoiler .spoiler-blur:hover>*{text-shadow:0 0 5px grey}.spoiler-box,.spoiler-box>*{transition:color .5s ease,background-color .5s ease}.spoiler .spoiler-box,.spoiler .spoiler-box>*{color:#000;background-color:#000;text-shadow:none}</style><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="AimTao" type="application/atom+xml">
</head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>AimTao&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> Home</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> Categories</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> Tags</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> About</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> Links</a></li><li class="nav-item"><a class="nav-link" href="/atom.xml"><i class="iconfont icon-rss"></i> RSS</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="iconfont icon-archive-fill"></i> Archives</a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/archives/">Timeline </a><a class="dropdown-item" href="/categories/Implement-From-Scratch/">Implement From Scratch </a><a class="dropdown-item" href="/tags/Kernel/">Linux kernel </a><a class="dropdown-item" href="/categories/Mark/">Mark</a></div></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(https://hutu.aimtao.net/web/2019-10-09-computer-network.webp-s) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="学习笔记｜计算机网络"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2019-10-09 15:07" pubdate>2019-10-09 PM</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 17k words </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 13 mins</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">学习笔记｜计算机网络</h1><div class="markdown-body"><blockquote><p>本文以 OSI 七层模型为脉络，系统描述计算机网络协议及其作用、特点。</p></blockquote><span id="more"></span><h2 id="一、概述">一、概述</h2><h3 id="1-概念">1.概念</h3><p>计算机网络主要由一些通用的、可编程的硬件互连 而成，通过这些硬件，可以传送不同类型的数据， 并且可以支持广泛和日益增长的应用。</p><ul><li>计算机网络不仅是软件概念，还包含硬件设备</li><li>计算机网络不仅是信息通信，还可以支持广泛的应用</li></ul><h3 id="2-分类">2.分类</h3><h4 id="1）作用范围">1）作用范围</h4><ul><li><strong>广域网WAN</strong> （Wide Area Network）</li><li><strong>城域网MAN</strong> （Metro Area Network）<ul><li>Metro：大都市的 adj.</li><li>5km～50km</li></ul></li><li><strong>局域网LAN</strong> （Local Area Network）<ul><li>1km之内</li></ul></li></ul><h4 id="2）网络的使用者">2）网络的使用者</h4><ul><li>公用网络</li><li>专用网络<ul><li>军队、银行、公司…</li></ul></li></ul><h3 id="3-发展历史">3.发展历史</h3><h4 id="1）互联网的发展历史">1）互联网的发展历史</h4><ul><li><strong>第一阶段：单个网络ARPANET</strong><ul><li>美国国防部最初建设</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-Wf97E2.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li><strong>第二阶段：三级结构互联网</strong><ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-4b0vsU.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li><strong>第三阶段 ISP（Internet Service Provider）：网络服务提供商</strong><ul><li>主干ISP：中国电信、移动、联通…</li><li>地区ISP：北京移动、上海联通…</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-eMMJJY.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li></ul><h4 id="2）现代国际互联网的主要线路">2）现代国际互联网的主要线路</h4><p><a href="https://live.infrapedia.com" rel="nofollow noopener" target="_blank">live.infrapedia.com</a></p><h4 id="3）中国互联网的发展历史">3）中国互联网的发展历史</h4><ul><li><p>1980，中国铁道部开始互联网实验</p></li><li><p>1989，第一个公有网络建立运行</p></li><li><p>1994，接入国际互联网</p></li></ul><h4 id="4）国内五个最大的公共网络">4）国内五个最大的公共网络</h4><ul><li><p>中国电信互联网CHINANET</p></li><li><p>中国联通互联网UNINET</p></li><li><p>中国移动互联网CMNET</p></li><li><p>中国教育与科研计算机网CERNET</p></li><li><p>中国科学技术网CSTNET</p></li></ul><h4 id="5）互联网公司">5）互联网公司</h4><ul><li>1996年，张朝阳创建搜狐</li><li>1997年，丁磊创建网易</li><li>1998年，王志东创建新浪</li><li>1998年，马化腾、张志东创建腾讯</li><li>1999年，马云创建阿里巴巴</li><li>2000年，李彦宏创建百度</li></ul><h2 id="二、层次结构">二、层次结构</h2><h3 id="1-层次结构设计的基本原则">1.层次结构设计的基本原则</h3><h4 id="1）为什么要使用层次结构设计">1）为什么要使用层次结构设计</h4><ul><li><strong>计算机网络要解决的问题</strong><ol><li>保证数据通路顺畅</li><li>识别目的计算机</li><li>目的计算机状态</li><li>数据是否错误</li></ol></li><li><strong>目的</strong><ul><li>分层解决不同的问题</li></ul></li></ul><h4 id="2）层次结构的例子">2）层次结构的例子</h4><table><thead><tr><th>网络应用数据</th><th>视频、文件、游戏</th><th>靠近用户</th></tr></thead><tbody><tr><td>数据可靠通信</td><td>数据错误、重复</td><td></td></tr><tr><td>物理网络接入</td><td>光电等物理特性</td><td>靠近底层</td></tr></tbody></table><h4 id="3）层次结构设计的基本原则">3）层次结构设计的基本原则</h4><ul><li>各层之间是互相独立的</li><li>每一层要有足够的灵活性</li><li>各层之间完全解耦</li></ul><h3 id="2-OSI七层模型">2.OSI七层模型</h3><table><thead><tr><th>应用层</th><th>为计算机用户提供接口和服务</th></tr></thead><tbody><tr><td>表示层</td><td>数据处理（编码解码、加密解密等）</td></tr><tr><td>会话层</td><td>管理（建立、维护、重连）通信会话</td></tr><tr><td>传输层</td><td>管理端到端的通信链接</td></tr><tr><td>网络层</td><td>数据路由（决定数据在网络的路径）</td></tr><tr><td>数据链路层</td><td>管理相邻节点之间的数据通信</td></tr><tr><td>物理层</td><td>数据通信的光电物理特性</td></tr></tbody></table><p><strong>结果</strong>：</p><ul><li>OSI在市场化过程中困难重重，TCP/IP在全球范围成功运行</li><li>OSI最终并没有成为广为使用的标准模型</li></ul><p><strong>原因</strong>：</p><ul><li><p>OSI的专家缺乏实际经验</p></li><li><p>OSI标准制定周期过长，按OSI标准生产的设备无法及时进入市场</p></li><li><p>OSI模型设计的并不合理，一些功能在多层中重复出现</p></li></ul><h3 id="3-TCP-IP四层模型">3.TCP/IP四层模型</h3><table><thead><tr><th>应用层</th><th>应用层</th><th>HTTP / FTP / SMTP / POP3</th></tr></thead><tbody><tr><td>表示层</td><td></td><td></td></tr><tr><td>会话层</td><td></td><td></td></tr><tr><td>传输层</td><td>传输层</td><td>TCP / UDP</td></tr><tr><td>网络层</td><td>网络层</td><td>IP / ICMP / ARP / RARP</td></tr><tr><td>数据链路层</td><td>网络接口层</td><td>Ethernet</td></tr><tr><td>物理层</td><td></td><td></td></tr></tbody></table><p><strong>传输方式</strong>：</p><p>发送方将数据层层封装后发送，接受方层层拆包后读取数据。</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-9uxpwU.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>协议</strong>：</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-LKJgB3.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>数据包的封装过程</strong>：</p><p><img src="https://hutu.aimtao.net/mark/2021-03-08-oC13aa.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>传输单元</strong>：</p><table><thead><tr><th>层次</th><th></th><th>协议数据单元（PDU）</th></tr></thead><tbody><tr><td>应用层</td><td>应用层</td><td>数据 data、报文 message</td></tr><tr><td>表示层</td><td></td><td>报文 message</td></tr><tr><td>会话层</td><td></td><td>报文 message</td></tr><tr><td>传输层</td><td>传输层</td><td>数据段、报文段 Segment</td></tr><tr><td>网络层</td><td>网络层</td><td>数据包 Packet，又称分组</td></tr><tr><td>数据链路层</td><td>网络接口层</td><td>数据帧 Frame</td></tr><tr><td>物理层</td><td></td><td>比特流 bit</td></tr></tbody></table><h2 id="三、网络拓扑">三、网络拓扑</h2><h3 id="1-边缘部分">1.边缘部分</h3><ul><li>用户所接触部分</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-nOuCVw.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-NFXkRr.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="2-核心部分">2.核心部分</h3><ul><li>主干部分，国家地区维护</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-lJbVXi.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="3-现代互联网的网络拓扑">3.现代互联网的网络拓扑</h3><p><img src="https://hutu.aimtao.net/mark/2020-02-29-S9IWzd.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="4-树状结构">4.树状结构</h3><p><img src="https://hutu.aimtao.net/mark/2020-02-29-SoMGZO.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="5-客户-服务器-C-S-模式">5.客户-服务器(C/S)模式</h3><p><img src="https://hutu.aimtao.net/mark/2020-02-29-hVHSUs.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="6-对等连接（P2P）模式">6.对等连接（P2P）模式</h3><p><img src="https://hutu.aimtao.net/mark/2020-02-29-0YgCDW.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h2 id="四、计算机网络的性能指标">四、计算机网络的性能指标</h2><table><thead><tr><th style="text-align:left"></th><th>bit</th><th>Byte</th><th>KB</th><th>MB</th><th>GB</th><th>TB</th><th>PB</th><th>EB</th></tr></thead><tbody><tr><td style="text-align:left">名称</td><td>比特位</td><td>字节</td><td>千字节</td><td>兆字节</td><td>吉字节</td><td>太字节</td><td>拍字节</td><td>艾字节</td></tr><tr><td style="text-align:left">比例</td><td></td><td>8bit</td><td>1024B</td><td>1024KB</td><td>1024MB</td><td>1024GB</td><td>1024TM</td><td>1024PB</td></tr><tr><td style="text-align:left">常用设备</td><td>门电路</td><td></td><td>寄存器</td><td>高速缓存</td><td>内存/硬盘</td><td>硬盘</td><td>云硬盘</td><td>数据仓库</td></tr></tbody></table><p><strong>PS</strong>：字：</p><ul><li>有32位字和64位字。</li><li>32位字等于4字节。</li><li>字是计算机一次处理数据的最大单位</li></ul><h3 id="1-速率">1.速率</h3><ul><li>100M光纤 = <strong>100Mbps</strong> = 100Mbit/s = <strong>（100/8）MB/s</strong> = 12.5MB/s</li></ul><h3 id="2-时延">2.时延</h3><ul><li>发送时延</li><li>传播时延</li><li>排队时延</li><li>处理时延</li></ul><h4 id="1）发送时延">1）发送时延</h4><p><img src="https://hutu.aimtao.net/mark/2020-02-29-r5QFmN.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="2）传播时延">2）传播时延</h4><p><img src="https://hutu.aimtao.net/mark/2020-02-29-wy6ayz.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="3）排队时延">3）排队时延</h4><ul><li>数据包在网络设备中等待被处理的时间</li></ul><h4 id="4）处理时延">4）处理时延</h4><ul><li>数据包到达设备或者目的机器被处理所需要的时间</li></ul><h3 id="3-往返时间RTT">3.往返时间RTT</h3><ul><li>RTT(Route-Trip Time)是评估网络质量的一项重要指标</li><li>RTT表示的是数据报文在端到端通信中的来回一次的时间</li><li>通常使用ping命令查看RTT</li></ul><h2 id="五、物理层">五、物理层</h2><blockquote><p><strong>数据通信的光电物理特性</strong></p></blockquote><h3 id="1-作用">1.作用</h3><ul><li>连接不同的物理设备<ul><li>主干ISP通过<strong>海底电缆</strong>连接</li><li>路由器到主机通过<strong>网线</strong>连接</li></ul></li><li>传输比特流</li></ul><h4 id="1）连接介质">1）连接介质</h4><ul><li>双绞线（常见的为网线）</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-gV7Grh.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ul><li>同轴电缆</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-kuv38X.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ul><li><p>光纤</p></li><li><p>红外线</p></li><li><p>无线（手机信号、Wi-Fi信号）</p></li><li><p>激光</p></li></ul><h4 id="2）比特流">2）比特流</h4><p><img src="https://hutu.aimtao.net/mark/2020-02-29-NVc5I8.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="3）物理特性">3）物理特性</h4><blockquote><p>物理层更多关注的是物理特性</p></blockquote><ul><li>机械特性</li><li>电气特性</li><li>功能特性</li><li>过程特性</li></ul><h3 id="2-信道">2.信道</h3><h4 id="1）概念">1）概念</h4><ul><li>信道是往一个方向传送信息的媒体</li><li>一个通信电路包括一个<strong>接收信道</strong>和一个<strong>发送信道</strong></li></ul><h4 id="2）信道分类">2）信道分类</h4><ul><li>单工通信信道<ul><li>只能一个方向通信，没有反方向反馈的信道</li><li>有线电视、无线电收音机</li></ul></li><li>半双工通信信道<ul><li>双方都可以发送和接收信息</li><li>不能双方同时发送，也不能同时接收</li></ul></li><li>全双工通信信道<ul><li>双方都可以同时发送和接收信息</li></ul></li></ul><h3 id="3-分用-复用技术">3.分用-复用技术</h3><ul><li><p>物理层所解决的问题</p><ul><li>多个计算机连接复用器，多个计算机连接分用器。通过复用器和分用器共享一条发送信道和接收信道，提高信道的利用效率</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-Ii3iem.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li><p>所用到的技术（应用在物理层中）</p><ul><li>频分复用</li><li>时分复用</li><li>波分复用</li><li>码分复用</li></ul></li></ul><h2 id="六、数据链路层">六、数据链路层</h2><blockquote><p><strong>管理相邻节点之间的数据通信</strong></p></blockquote><h3 id="1-封装成帧">1.封装成帧</h3><ul><li><strong>”帧“</strong> 是数据链路层的基本单位</li><li><strong>发送端</strong> 在网络层的一段数据前后 添加特定标记形成“帧”<ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-m6rnJq.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li><strong>接收端</strong>根据前后特定标记识别出“帧”（物理层只传输比特流，不处理帧）</li><li>帧首部和尾部是特定的控制字符(特定比特流)<ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-SRNcFe.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li></ul><h3 id="2-透明传输">2.透明传输</h3><ul><li>“透明”在计算机领域是非常重要的一个术语。</li><li>透明传输指的是，无论上层交付给数据链路层什么数据，数据链路层都好像是看不见这个数据一样将这个数据传输出去。</li><li>即使有控制字符在帧数据中，数据链路层也当做不存在的去处理。如何当作不存在呢？看下面的问题和处理。</li></ul><ul><li><strong>问题</strong>：识别错误的帧</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-TGOSw9.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ul><li><strong>处理</strong>：对数据中的控制字符进行特殊处理（类似添加转移字符ESC）</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-fdqxOf.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="3-差错检测">3.差错检测</h3><ul><li>物理层只管传输比特流，无法控制是否出错</li><li>数据链路层负责起“差错监测”的工作</li></ul><h4 id="1）奇偶校验码">1）奇偶校验码</h4><ul><li><p>在比特流最后一位，添加奇偶校验码（奇数为1，偶数为0）</p><ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-9brwSk.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li><p><strong>局限性</strong>：同时出错两位，奇偶校验码不变</p><ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-TYhSde.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li></ul><h4 id="2）循环冗余校验码CRC">2）循环冗余校验码CRC</h4><ul><li>一种根据传输或保存的数据而产生<strong>固定位数校验码</strong>的方法</li><li>检测数据传输或者保存后可能出现的错误</li><li>生成的数字计算出来并且<strong>附加到数据后面</strong></li></ul><p><strong>模2除法</strong>：</p><ul><li>模 “2”除法是二进制下的除法</li><li>与算术除法类似，但除法不借位，是“异或”操作</li><li>异或：相同为0，不同为1<ul><li>0 xor 0 = 0</li><li>1 xor 1 = 0</li><li>0 xor 1 = 1</li><li>1 xor 0 = 1</li></ul></li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-cuDUqi.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>具体操作</strong>：</p><ul><li><p>选定一个用于校验的多项式G(x)，并在数据尾部添加r个0</p></li><li><p>将添加r个0后的数据，使用模“2”除法除以多项式的位串</p></li><li><p>得到的余数填充在原数据r个0的位置得到可校验的位串</p></li><li><p><strong>接收端</strong>接收的数据除以G(x)的位串，根据余数判断出错</p></li></ul><p><strong>其他</strong>：</p><ul><li>CRC的错误检测能力与位串的阶数r有关<ul><li>另：当G(x)变成 x+1 时，CRC变成奇偶校验码</li></ul></li><li>数据链路层只进行数据的检测，不进行纠正</li></ul><h4 id="3）最大传输单元MTU">3）最大传输单元MTU</h4><ul><li><p>最大传输单元MTU(Maximum Transmission Unit)</p></li><li><p>数据链路层的数据帧也不是无限大的</p><ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-X5GPFG.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li><p>数据帧过大或过小都会影响传输的效率</p><ul><li><p>以太网MTU一般为1500字节</p></li><li><p>总时延=发送时延+排队时延+传播时延+处理时延</p><ul><li>过小影响发送时延</li><li>过多影响处理时延</li></ul></li></ul></li></ul><h4 id="4）路径MTU">4）路径MTU</h4><ul><li><p>路径MTU由链路中MTU的最小值决定</p></li><li><p>该路径中，路径MTU为1492</p><ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-zo9EUj.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li></ul><h4 id="5）以太网协议">5）以太网协议</h4><h5 id="1-MAC地址">&lt;1&gt;MAC地址</h5><ul><li>MAC地址(物理地址、硬件地址、以太网地址)</li><li>每一个设备都拥有唯一的MAC地址</li><li>MAC地址共48位，使用十六进制表示<ul><li>例：30-B4-9E-ED-85-CA</li><li>4 x 6 x 2 = 48位</li></ul></li></ul><h5 id="2-以太网协议">&lt;2&gt;以太网协议</h5><ul><li><p>以太网(Ethernet)是一种使用广泛的<strong>局域网</strong>技术</p></li><li><p>以太网是一种应用于数据链路层的协议</p></li><li><p>使用以太网可以完成<strong>相邻设备</strong>的数据帧传输</p></li><li><p><strong>以太网协议内容</strong>：</p></li></ul><table><thead><tr><th>名称</th><th>目的地址D.MAC</th><th>源地址S.MAC</th><th>类型Type</th><th>帧数据Data</th><th>FCS（CRC校验码）</th></tr></thead><tbody><tr><td>长度</td><td>6</td><td>6</td><td>2</td><td>46～1500</td><td>4</td></tr></tbody></table><ul><li><p><strong>有关类型</strong>：<img src="https://hutu.aimtao.net/mark/2020-02-29-MykUS2.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p><strong>MAC地址表</strong>：</p><ul><li>MAC地址 <strong>映射到</strong> 具体的硬件接口</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-2GMKqD.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li><p><strong>相邻设备的数据帧传输：（只能相邻节点）</strong></p><ul><li>A通过网卡发出数据帧</li><li>数据帧到达路由器，路由器取出前6字节（目的地址）</li><li>路由器匹配MAC地址表，找到对应的网络接口</li><li>路由器往该网络接口发送数据帧</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-SmVN0S.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li><h5 id="若路由器不知道C的MAC地址：">若路由器不知道C的MAC地址：</h5><ul><li>检查MAC地址表，发现没有C的信息</li><li>E将广播A的数据包到除A以外的端口</li><li>E将收到来自B、C的回应，并将地址记录</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-nDSjvO.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li></ul><h2 id="七、网络层">七、网络层</h2><blockquote><p><strong>数据路由(决定数据在网络的路径)</strong></p></blockquote><h3 id="1-IP协议">1.IP协议</h3><h4 id="1）虚拟互联网络">1）虚拟互联网络</h4><ul><li>实际的计算机网络是错综复杂的</li><li>物理设备通过使用IP协议，屏蔽了物理网络之间的差异</li><li>当网络中的主机使用IP协议连接时，则无需关注网络细节（重点关注端到端）</li></ul><p><strong>实际计算机网络</strong>：</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-yrj5aC.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>虚拟互联网络</strong>：</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-mL7JVq.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="2）IP协议">2）IP协议</h4><h5 id="1-作用-2">&lt;1&gt;作用</h5><ul><li>IP协议使得复杂的实际网络变为一个虚拟互连的网络</li><li>IP协议使得网络层可以屏蔽底层细节而专注网络层的数据转发</li><li>IP协议<strong>解决了在虚拟网络中数据报传输路径的问题</strong></li></ul><h5 id="2-IP结构">&lt;2&gt;IP结构</h5><ul><li>IP地址长度为32位，常分成4个8位，用点分割</li><li><strong>点分十进制</strong>（0~255. 0~255. 0~255. 0~255）</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-0Q2DuG.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul><h5 id="3-IP首部">&lt;3&gt;IP首部</h5><ul><li><p>IP首部在IP数据报中<img src="https://hutu.aimtao.net/mark/2020-02-29-gjhdGv.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p><strong>IP首部</strong>：</p></li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-S7Q0R9.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ul><li><strong>版本</strong>：占4位，指的是IP协议的版本，通信双方的版本必须一 致，当前主流版本是4，即IPv4，也有IPv6</li><li><strong>首部位长度</strong>：占4位，最大数值为15，表示的是IP首部长度，单位是“32位字”(4个字节)，也即是IP首部最大长度为60字节，最少长度20字节（5 x 32位 = 5 x 4字节）</li><li><strong>总长度</strong>：占16位，最大数值为 65535，表示的是IP数据报总长 度(IP首部+ I P 数据)<ul><li>当总长度超过MTU，</li></ul></li><li><strong>标志</strong>：标志IP数据报是否可以分片</li><li><strong>片偏移</strong>：若要分片，记录第几个偏移数据</li><li><strong>TTL</strong>：占8位，表明IP数据报文 在网络中的寿命，每经过一个 设备，TTL减1，当TTL=0时， 网络设备必须丢弃该报文</li><li><strong>协议</strong>：占8位，表明IP数据所携带的具体数据是什么协议的 (如:TCP、UDP等)</li><li><strong>首部校验和</strong>：占16位，校验IP 首部是否有出错</li></ul><h3 id="2-IP协议的转发流程">2.IP协议的转发流程</h3><h4 id="1）逐跳（hop-by-hop）">1）逐跳（hop-by-hop）</h4><ul><li>一跳一跳的转发到目的主机</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-xSDyI0.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul><h4 id="2）路由表">2）路由表</h4><ul><li>计算机或者路由器都拥有路由表</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-dPsMuZ.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul><h4 id="3）IP协议的转发流程">3）IP协议的转发流程</h4><ul><li><p>从网络层来看，</p></li><li><p>通过查询路由表，确定下一跳，并转发</p><ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-bG25IK.webp-s" srcset="/img/loading.gif" lazyload alt=""></li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-ItFCIn.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li><p>从网络层和数据链路层来看，</p></li><li><p>通过路由表查询，确定下一跳，并交给数据链路层将下一跳转化成MAC地址，封装数据帧并发送</p><ul><li><p><img src="https://hutu.aimtao.net/mark/2020-02-29-3fYm6g.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p>A --&gt; E<img src="https://hutu.aimtao.net/mark/2020-02-29-SfWItc.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p>E --&gt; F<img src="https://hutu.aimtao.net/mark/2020-02-29-vxyq78.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p>F --&gt; C<img src="https://hutu.aimtao.net/mark/2020-02-29-bX3aP0.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul></li><li><p>注意：</p><ul><li>数据帧<strong>每一跳的MAC地址都在变化</strong></li><li>IP数据报<strong>每一跳的IP地址始终不变</strong></li><li>ARP请求报文的MAC地址和IP地址都在变化</li></ul><p>上述 IP 均表示：源 IP 和 目的 IP。上述 MAC 均表示：源 MAC 和 目的 MAC。</p></li></ul><h3 id="3-ARP协议与RARP协议">3.ARP协议与RARP协议</h3><blockquote><p>协调网络层和数据链路层的配合工作</p></blockquote><h4 id="1）ARP协议">1）ARP协议</h4><ul><li>ARP(Address Resolution Protocol)地址解析协议</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-tbX9T8.webp-s" srcset="/img/loading.gif" lazyload alt=""></li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-sZ0dKp.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul><p><strong>若ARP缓存表中没有缓存</strong>：</p><ul><li>ARP缓存表<strong>没有</strong>缓存IP地址和MAC地址的映射关系<ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-pEBw1J.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li></ul><p><strong>结构</strong>：</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-wKyRvh.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>注意</strong>：</p><ul><li>ARP缓存表是ARP协议和RARP协议运行的关键</li><li>ARP缓存表缓存了IP地址到硬件地址之间的映射关系</li><li>ARP缓存表中的记录并<strong>不是永久有效的</strong>，有一定的期限 （随着IP的变化而变化）</li></ul><p><strong>其他</strong>：</p><ul><li><p>在以太网协议中，如果类型为 0806，则发送的是 ARP 请求/应答。</p></li><li><p>ARP 请求报文的最后面，PAD 是填充字节，让 ARP 请求满足以太网协议的最小长度 46 的限制。</p><p>PS：PAD 是填充的意思，iPad 是为了填充 iPhone 和 iMac。</p></li></ul><h4 id="2）RARP协议">2）RARP协议</h4><ul><li><p>RARP(Reverse Address Resolution Protocol)逆地址解析协议</p><ul><li>不常用</li><li>使用场景：无盘主机，向ARP服务器广播，从而获取自己的IP地址</li></ul></li><li><p><img src="https://hutu.aimtao.net/mark/2020-02-29-PjAGy5.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul><p><strong>结构</strong>：</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-NeShe9.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>注意</strong>：</p><ul><li>®ARP协议是TCP/IP协议栈里面基础的协议</li><li>ARP和RARP的操作对程序员是透明的</li><li>理解®ARP协议有助于理解网络分层的细节</li></ul><h3 id="4-IP地址的子网划分">4.IP地址的子网划分</h3><h4 id="1）IP地址的分类">1）IP地址的分类</h4><ul><li><p><img src="https://hutu.aimtao.net/mark/2020-02-29-RLFhuM.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><table><thead><tr><th></th><th>最小网络号</th><th>最大网络号</th><th>子网数量</th><th>最小主机号</th><th>最大主机号</th><th>主机数量</th></tr></thead><tbody><tr><td>A</td><td>1</td><td>01111111:127</td><td>2^7-2</td><td>0.0.1</td><td>255.255.254</td><td>2^24-2</td></tr><tr><td>B</td><td>128.1</td><td>191.255</td><td>2^14-1</td><td>0.1</td><td>255.254</td><td>2^16-2</td></tr><tr><td>C</td><td>192.0.1</td><td>223.255.255</td><td>2^21-1</td><td>1</td><td>254</td><td>2^8-2</td></tr></tbody></table></li><li></li><li><p>A类子网数量 -2 是 <code>00000000</code> <code>01111111:127</code></p></li><li><p>B、C类子网数量 -1 是<code>10000000.00000000:128.0</code> <code>192.0.0</code>【网络号全0】</p></li><li><p>主机数量 -2 是 当前网络段【主机号全0】广播地址【主机号全1】</p></li><li><p><strong>特殊的主机号</strong></p><ul><li>主机号全0表示当前网络段，不可分配为特定主机</li><li>主机号为全1表示广播地址，向当前网络段所有主机发消息</li><li>例子：1.2.3.4<ul><li>1.0.0.0（主机号全为0，表当前网络段）</li><li>1.255.255.255（主机号全为1，表广播地址）</li></ul></li></ul></li><li><p><strong>特殊的网络号</strong></p><ul><li>A 类地址网络段全0(00000000)表示特殊网络</li><li>A 类地址网络段后7位全1(01111111:127)表示回环地址</li><li>B类地址网络段(10000000.00000000:128.0)是不可使用的</li><li>C类地址网络段(192.0.0)是不可使用的</li></ul></li></ul><h4 id="2）127-0-0-1">2）127.0.0.1</h4><p>127.0.0.1，通常被称为本地回环地址(Loopback Address)，不属于任何 一 个有类别地址类。它代表设备的本地虚拟接口，所以默认被看作是永远 不会宕掉的接口。在Windows操作系统中也有相似的定义，所以通常在 安 装网卡前就可以ping通这个本地回环地址。一般都会用来检查本地网络 协 议、基本数据接口等是否正常的。</p><h4 id="3）D类和E类">3）D类和E类</h4><p>D类：1110…</p><p>E类：1111…</p><h4 id="4）子网划分">4）子网划分</h4><ul><li><p>将主机号拿出来一部分，当作网络号，叫子网号</p></li><li><p><img src="https://hutu.aimtao.net/mark/2020-02-29-udnhUg.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul><h4 id="5）子网掩码">5）子网掩码</h4><p><strong>作用</strong>：</p><p>判断某个IP的网络号（不算子网号）</p><p><strong>特点</strong>：</p><ul><li>子网掩码和IP地址一样，都是32位</li><li>子网掩码由连续的1和连续的0组成</li><li>某一个子网的子网掩码具备网络号（网络号和子网号）位数个连续的1</li></ul><p><strong>例子</strong>：</p><ul><li><p>将网络号和子网号设为1，主机号设为0<img src="https://hutu.aimtao.net/mark/2020-02-29-t36GWF.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p>IP和子网掩码进行 <strong>与运算</strong></p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-EN6TY5.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul><h4 id="6）无分类编址CIDR">6）无分类编址CIDR</h4><ul><li><p><strong>现代网络划分的方式</strong></p></li><li><p>CIDR中没有A 、B、C类网络号、和子网划分的概念</p></li><li><p>CIDR将网络前缀相同的IP地址称为一个 “CIDR地址块”</p></li><li><p><img src="https://hutu.aimtao.net/mark/2020-02-29-mRuIXf.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul><p><strong>例子</strong>：</p><ul><li><p><img src="https://hutu.aimtao.net/mark/2020-02-29-9Rb54i.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p>/25 表示前25位是网路前缀，后7位是主机号</p></li><li><p>更多的前缀长度<img src="https://hutu.aimtao.net/mark/2020-02-29-giLM3U.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul><p><strong>问题</strong>：</p><p>1.某公司拥有100名员工，每人配备一个计算机，请问该公司应该申请 哪种网络段?</p><ul><li>分配一个 /25 的网络前缀的IP网络号就可以</li></ul><p>2.某公司增加了100名员工，并且拆分成两个部门。</p><ul><li><p>申请一个 /24 为网络前缀的网络号，再在其中申请两个 /25 为网络前缀的网络号</p></li><li><p><img src="https://hutu.aimtao.net/mark/2020-02-29-8aRajE.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p><strong>注</strong>：小型网络称为 <strong>子网</strong>，中型网络称为 <strong>超网</strong></p></li></ul><p><strong>拓展</strong>：某个城市的CIDR划分</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-POdwMh.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="5-网络地址转换的NAT技术">5.网络地址转换的NAT技术</h3><h4 id="1）边缘部分使用内网IP">1）边缘部分使用内网IP</h4><ul><li>一个家庭网关只有一个外网IP地址，家庭其他设备使用内网IP地址</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-pzeRqN.webp-s" srcset="/img/loading.gif" lazyload alt=""></li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-F5wWWz.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul><h4 id="2）内网与外网">2）内网与外网</h4><p><strong>内网地址</strong>：</p><ul><li>内部机构使用（家庭的笔记本手机各种设备）</li><li>避免与外网地址重复</li></ul><p><strong>外网地址</strong>：</p><ul><li>全球范围使用</li><li>全球公网唯一</li></ul><h4 id="3）三类内网IP">3）三类内网IP</h4><ul><li>10.0.0.0~10.255.255.255(支持千万数量级设备)</li><li>172.16.0.0~172.31.255.255(支持百万数量级设备)</li><li>192.168.0.0~192.168.255.255(支持万数量级设备)</li></ul><h4 id="4）问题">4）问题</h4><ul><li><p>内网多个设备使用同一个外网IP请求外网的服务，外部怎么知道具体是哪个设备在请求的?</p></li><li><p><img src="https://hutu.aimtao.net/mark/2020-02-29-ev3mZn.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p>解决办法：NAT技术</p></li></ul><h4 id="5）网络地址转换NAT技术（NAPT技术）">5）网络地址转换NAT技术（NAPT技术）</h4><ul><li>网络地址转换NAT(Network Address Translation)</li><li>NAT技术用于多个主机通过一个公有IP访问互联网的私有网络中</li><li>NAT减缓了IP地址的消耗，但是增加了网络通信的复杂度</li></ul><p><strong>端口号（Port）</strong>：</p><ul><li>通过端口号可以指定某个设备具体哪个进程在使用网络</li></ul><p><strong>具体操作</strong>：</p><ul><li>终端设备的 <strong>内网IP和端口号</strong>，通过路由器的 <strong>NAT技术</strong>，转换为 <strong>公网IP+新端口号</strong></li><li>NAT技术的映射的表称为 <strong>NAT表</strong> 或者 <strong>NAPT表</strong>（P表端口）</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-go1BV2.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul><h3 id="6-ICMP协议">6.ICMP协议</h3><h4 id="1）作用">1）作用</h4><ul><li><p>辅助IP协议进行数据传输的</p></li><li><p>网际控制报文协议(Internet Control Message Protocol)</p></li><li><p>ICMP协议可以报告错误信息或者异常情况</p></li></ul><h4 id="2）格式">2）格式</h4><ul><li><p><img src="https://hutu.aimtao.net/mark/2020-02-29-9qUgHv.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p>ICMP报文封装在IP数据报中，通过IP协议进行数据传输</p></li><li><p>如果IP数据报传输的是ICMP报文，则在IP首部中的8位协议字段值是1</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-jZbmpo.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul><h4 id="3）ICMP首部">3）ICMP首部</h4><ul><li>首部一共有32位</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-fbqhF0.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="4）ICMP报文种类">4）ICMP报文种类</h4><h5 id="1-差错报告报文">&lt;1&gt;差错报告报文</h5><ul><li>8位类型是类型的值</li><li>8位代码是具体代码</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-6LBi7Q.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h5 id="2-询问报文">&lt;2&gt;询问报文</h5><p><img src="https://hutu.aimtao.net/mark/2020-02-29-LAWlCk.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="7-ICMP应用">7.ICMP应用</h3><h4 id="1）ping">1）ping</h4><ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-alGFO2.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 返回信息</span><br>64 bytes from 39.156.69.79: icmp_seq=0 ttl=49 <span class="hljs-keyword">time</span>=33.518 ms<br></code></pre></td></tr></table></figure><ul><li><p>返回信息：</p><ul><li><strong>64 bytes</strong>： IP数据报的长度（其中IP首部最少占20字节）</li><li><strong>icmp_seq=0</strong>：echo_requst，请求次数</li><li><strong>ttl=49</strong>：这个报文在网络中传输之后还剩下的寿命</li><li><strong>time=33.518 ms</strong>：从请求到应答的时间</li></ul></li><li><p>用ping进行网络排查</p><ul><li>ping回环地址127.0.0.1【本机地址】</li><li>ping网关地址192.168.0.1 或 192.168.1.1【路由器地址】</li><li>ping远端地址【检查ISP到内网的网络】</li></ul></li></ul><h4 id="2）traceroute">2）traceroute</h4><ul><li>Traceroute可以探测IP数据报在网络中走过的路程</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">traceroute baidu.com  <span class="hljs-comment"># linux</span><br>tracert baidu.com     <span class="hljs-comment"># windows</span><br></code></pre></td></tr></table></figure><p><strong>原理</strong>：</p><ol><li>发送 ttl=1 的询问报文，返回原主机一个终点不可达差错报文</li><li>发送 ttl=2 的询问报文，返回原主机一个终点不可达差错报文</li><li>…</li><li>直到询问报文达到目的主机，告知原主机已成功接收</li></ol><p><img src="https://hutu.aimtao.net/mark/2020-02-29-4S0lkn.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="8-路由概述">8.路由概述</h3><h4 id="1）网络层路由需要解决的问题">1）网络层路由需要解决的问题</h4><ul><li>路由表是怎么来的？</li><li>下一跳地址是怎么来的？</li><li>下一跳地址是唯一的吗？</li><li>下一跳地址是最佳的吗？</li><li>路由器这么多，他们是怎么协同工作的？</li></ul><p>==&gt;<strong>需要一个好的算法解决这些事情</strong></p><h4 id="2）路由算法本质">2）路由算法本质</h4><ul><li>网络拓扑转化为图</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-JItdCS.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul><p><strong>路由算法的要求</strong>：</p><ul><li>算法是 <strong>正确的</strong>、<strong>完整的</strong></li><li>算法在计算上尽可能的 <strong>简单</strong></li><li>算法可以 <strong>适应网络中的变化</strong></li><li>算法是 <strong>稳定的</strong>、<strong>公平的</strong></li></ul><h4 id="3）自治系统（AS）">3）自治系统（AS）</h4><p><strong>问题背景</strong>：</p><p>互联网的规模的非常大</p><p>互联网环境是非常复杂</p><p>==&gt;<strong>对互联网进行划分</strong></p><p><strong>概念</strong>：</p><ul><li><p>自治系统（Autonomous System）</p></li><li><p>一个自治系统（AS）是处于一个管理机构下的网络设备群</p></li><li><p>AS内部网络自行管理，AS对外提供一个或多个出（入）口</p></li><li><p>主干ISP就是一个主干AS，地区ISP就是一个地区AS<img src="https://hutu.aimtao.net/mark/2020-02-29-KemM5r.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul><p><strong>协议</strong>：</p><ul><li>自治系统内部路由的协议称为:内部网关协议(RIP、OSPF)</li><li>自治系统外部路由的协议称为:外部网关协议(BGP)</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-tQvfe5.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul><h3 id="9-内部网关协议之RIP协议">9.内部网关协议之RIP协议</h3><h4 id="1）距离矢量（DV）算法">1）距离矢量（DV）算法</h4><p><strong>概念</strong>：</p><ul><li>每一个节点使用两个向量𝐷𝑖和S𝑖</li><li>𝐷𝑖描述的是当前节点到别的节点的距离</li><li>S𝑖描述的是当前节点到别的节点的下一节点</li></ul><p><strong>运行</strong>：</p><ul><li><p>每一个节点与相邻的节点交换向量𝐷𝑖和S𝑖的信息</p></li><li><p>每一个节点根据交换的信息更新自己的节点信息</p></li></ul><p><strong>交换过程</strong>：</p><ol><li>A和B交换信息，计算 A通过B 到达B、C、D、E、F的距离，即：<code>B到A</code> + <code>B到C、D、E、F</code>，计算后的距离和 <code>A到各点距离（Dai）</code>比较，取最小值，并更新 <code>Dai</code>向量值。并将 下一跳<code>Sai</code> 更新为 B</li><li>以此类推，A继续和C交换信息…</li></ol><p><img src="https://hutu.aimtao.net/mark/2020-02-29-m02Nda.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="2）RIP协议的过程">2）RIP协议的过程</h4><ul><li><p>RIP（Routing information Protocol）协议</p></li><li><p>RIP协议是使用DV算法的一种路由协议</p></li></ul><p><strong>内容</strong>：</p><ul><li>RIP协议把网络的跳数(hop)作为DV算法的距离</li><li>RIP协议 <strong>每隔30s</strong> 交换一次路由信息</li><li>RIP协议认为 <strong>跳数&gt;15</strong> 的路由则为不可达路由</li></ul><p><strong>具体过程</strong>：</p><ol><li><p>路由器初始化路由信息(两个向量𝐷𝑖和S𝑖)</p></li><li><p>对相邻路由器X发过来的信息，对信息的内容进行修改(下一跳地址设置为X，所有距离加1)</p><p>i. 检索本地路由，将信息中<strong>新的路由</strong>插入到路由表里面</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-5fVkQj.webp-s" srcset="/img/loading.gif" lazyload alt=""><br>ii. 检索本地路由，对于下一跳为X<strong>的，<strong>更新</strong>为修改后的信息</strong></p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-Me9DWj.webp-s" srcset="/img/loading.gif" lazyload alt="">iii. 检索本地路由，对比相同目的的距离，如果新信息的<strong>距离更小</strong>，则<strong>更新</strong>本地路由表</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-7yFWPS.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p>如果3分钟没有收到相邻的路由信息，则把相邻路由设置为不可达(16跳)</p></li></ol><p><strong>缺点</strong>：故障信息传递慢</p><ul><li>如果A宕机，B询问C，C询问B，一直循环到16跳，设置为不可达。<ul><li>随便相信“隔壁老王”</li><li>“自己不思考” “视野不够”<ul><li>只看到相邻节点的信息，看不到更远的信息</li></ul></li></ul></li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-qL5nov.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>特点</strong>：</p><ul><li>实现简单，开销很小</li><li>限制了网络的规模<ul><li>最大跳数为15跳</li></ul></li><li>故障信息传递慢，更新收敛时间过长</li></ul><h3 id="10-Dijkstra（迪杰斯特拉）算法">10.Dijkstra（迪杰斯特拉）算法</h3><ul><li>Dijkstra算法是著名的<strong>图算法</strong></li><li>Dijkstra算法解决有权图<strong>从一个节点到其他节点的最短路径问题</strong></li><li>“以起始点为中心，向外层层扩展”</li></ul><p><strong>具体过程</strong>：</p><ol><li><p>初始化两个集合(S, U)(S为只有初始顶点点A的集合，U为其他顶点集合)</p></li><li><p>如果U不为空， 对U集合顶点进行距离的排序，并取出距离A最近的一个顶点B <img src="https://hutu.aimtao.net/mark/2020-02-29-J7FYeA.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p>i. 将顶点B的纳入S集合 <img src="https://hutu.aimtao.net/mark/2020-02-29-LFUI67.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p>ii.更新通过顶点B到达U集合所有点的距离（如果距离更小则更新，否则不更新）</p><p>iii. 重复2步骤</p></li><li><p>知道U集合为空，算法完成</p></li></ol><h3 id="11-内部网关路由协议之OSPF协议">11.内部网关路由协议之OSPF协议</h3><h4 id="1）链路状态（LS）协议">1）链路状态（LS）协议</h4><ul><li><p>向所有的路由器发送消息</p><ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-jzQ46B.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li><p>消息描述该路由器与相邻路由器的<strong>链路状态</strong></p><ul><li><img src="https://hutu.aimtao.net/mark/2020-02-29-SvXEZQ.webp-s" srcset="/img/loading.gif" lazyload alt=""></li><li>更符合人类管理需要</li><li>链路状态 = 网络连接的代价</li></ul></li><li><p>只有链路状态发生变化时，才发送更新信息</p><ul><li>RIP协议 每隔30秒交换路由信息</li></ul></li></ul><h4 id="2）OSPF协议的过程">2）OSPF协议的过程</h4><ul><li><p>OSPF（Open Shortest Path First：开放最短路径优先）</p></li><li><p>OSPF 协议的核心是Dijkstra算法</p></li></ul><p><strong>利用LS协议和Dijkstra算法</strong>：</p><ol><li>向所有的路由器发送消息<ul><li>每个路由器都能获得网络中所有消息，即可获得“网络的完整拓扑”</li><li>“网络的完整拓扑” 也称为 ”链路状态数据库“</li><li>”链路状态数据库“ 是全网一致的</li><li>每个路由器都可以运行Dijkstra算法，就可以找到自己到其他节点的最短路径</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-KmdqFA.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li>消息描述该路由器与相邻路由器的链路状态<ul><li>OSPF协议更加客观、更加先进</li></ul></li><li>只有链路状态发生变化时，才发送更新信息<ul><li>减少了数据的交换，更快收敛</li></ul></li></ol><p><strong>五种消息</strong>：</p><ul><li><p>问候消息（hello）</p><ul><li>维护该路由器到其他路由器的可达性的</li></ul></li><li><p>数据链路数据库描述信息</p><ul><li>用于隔壁路由器发送自己的所有链路状态信息</li></ul></li><li><p>链路状态请求信息</p><ul><li>用于向隔壁路由器请求链路状态数据库</li></ul></li><li><p><strong>链路状态更新信息</strong></p><ul><li>特别频繁的一个消息</li><li>每个路由器若更新链路状态，即通过此消息广播到整个网络</li></ul></li><li><p>链路状态确认信息</p></li></ul><p><strong>过程</strong>：</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-njHapS.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>对比</strong>：</p><table><thead><tr><th>RIP协议</th><th>OSPF协议</th></tr></thead><tbody><tr><td>从邻居看网络</td><td>整个网络的拓扑</td></tr><tr><td>在路由器之间累加距离</td><td>Dijkstra算法计算最短路径</td></tr><tr><td>频繁、周期更新、收敛很慢</td><td>状态变化更新、收敛很快</td></tr><tr><td>路由间拷贝路由信息</td><td>路由间传递链路状态，自行计算路径</td></tr></tbody></table><h3 id="12-外部网关路由协议之BGP协议">12.外部网关路由协议之BGP协议</h3><ul><li>BGP(Border Gateway Protocol: 边际网关协议)</li><li>BGP协议是运行在AS之间的一种协议</li></ul><h4 id="1）使用BGP原因">1）使用BGP原因</h4><ul><li>互联网的规模很大</li><li>AS内部使用不同的路由协议</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-YribAP.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ul><li>AS之间需要考虑除网络特性以外的一些因素(政治、安全…)<ul><li>AS2不想让AS1通过它传递信息给AS4</li><li>AS1不想讲敏感信息通过AS2传递</li></ul></li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-zPIHVc.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>因为以上种种原因的限制</strong>：</p><ul><li>BGP协议能够找到一条到达目的比较好的路由</li><li>而不是最短的路由（Dijkstra算法计算的才是最短路由）</li></ul><h4 id="2）BGP发言人（speaker）">2）BGP发言人（speaker）</h4><ul><li>BGP并不关心内部网络拓扑</li><li>AS之间通过BGP发言人交流信息</li><li>BGP Speaker可以人为配置策略<ul><li>网络可以人为地干预</li><li>可以让你经过我的AS，也可以不让你经过我的AS</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-CykO44.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li></ul><p><strong>BGP发言人就是AS的边界路由器</strong>：</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-pwLmL5.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h2 id="八、传输层">八、传输层</h2><blockquote><p><strong>管理端到端的通信链接</strong></p></blockquote><h3 id="1-作用-3">1.作用</h3><ul><li><p>网络层提供了一个虚拟的互联网络，解决数据传输走向问题</p></li><li><p>解决进程与进程的通信</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-9D9LJI.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul><h3 id="2-端口">2.端口</h3><ul><li>使用端口(Port)来标记不同的网络进程</li><li>端口(Port)使用16比特位表示(0~65535)</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-zb8xxQ.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="3-UDP协议详解">3.UDP协议详解</h3><ul><li><p>UDP（User Datagram Protcol：用户数据报协议）</p></li><li><p>UDP是一个非常简单的协议</p><ul><li>收到Data后，不拆分不合并，直接封装到UDP协议报文中</li></ul></li></ul><h4 id="1）位置">1）位置</h4><ul><li>应用层数据直接封装成UDP数据报的数据，不做任何处理</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-CwBJYf.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="2）UDP首部">2）UDP首部</h4><p><img src="https://hutu.aimtao.net/mark/2020-02-29-KIHvoq.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ul><li><p><strong>16位源端口号</strong>：原机器使用网络的进程（C/S模式，客户端和服务端提前准备约定好的。）</p></li><li><p><strong>16位目的端口号</strong>：目的机器使用网络的进程（C/S模式，客户端和服务端提前准备约定好的。）</p></li><li><p><strong>16UDP长度</strong>：最小是8（UDP首部）</p></li><li><p><strong>16位UDP校验和</strong>： 检测UDP数据报在传输中是否发生错误</p></li></ul><h4 id="3）特点">3）特点</h4><ul><li>UDP是无连接协议<ul><li>无需提前建立连接</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-B4M9CT.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li>UDP不能保证可靠的交付数据<ul><li>无法保证数据在网络中是否丢失</li></ul></li><li>UDP是面向报文传输的<ul><li>不对报文做任何处理</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-Rw5Qxy.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li><li>UDP没有拥塞控制</li><li>UDP首部开销非常小（UDP首部最少8个字节）</li></ul><h3 id="4-TCP协议详解">4.TCP协议详解</h3><ul><li><p>TCP（Transmission Control Protocol：传输控制协议）</p></li><li><p>TCP协议是计算机网络中非常复杂的一个协议</p></li></ul><h4 id="1）位置-2">1）位置</h4><p><img src="https://hutu.aimtao.net/mark/2020-02-29-zCFnA8.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="2）特点">2）特点</h4><ul><li><p>TCP是 <strong>面向连接</strong> 的协议</p><ul><li>TCP需要通信先要建立连接</li></ul></li><li><p>TCP的一个连接有两端(<strong>点对点通信</strong>)</p></li><li><p>TCP提供 <strong>可靠的</strong> 传输服务</p></li><li><p>TCP协议提供 <strong>全双工的</strong> 通信</p></li><li><p>TCP是面对 <strong>字节流的</strong> 协议</p><ul><li>将数据视为字节流，进行拆分合并</li><li><img src="https://hutu.aimtao.net/mark/2020-02-29-rKlYnz.webp-s" srcset="/img/loading.gif" lazyload alt=""></li></ul></li></ul><h4 id="3）结构">3）结构</h4><blockquote><p>传输层的UDP协议固定8字节</p><p>传输层的TCP协议首部最少20字节，最多60字节（4字节 x 15）</p><p>网络层的IP协议固定20字节</p></blockquote><p><img src="https://hutu.aimtao.net/mark/2020-02-29-f7xRcZ.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>序号</strong>：</p><ul><li>范围：0~2^32-1</li><li>一个字节一个序号</li><li>数据<strong>首字节序号</strong></li></ul><p><strong>确认号</strong>：</p><ul><li>0~2^32-1</li><li>一个字节一个序号</li><li>期望收到数据的首字节序号</li></ul><p>例：</p><ul><li><p>501为<strong>序号</strong>，601为<strong>确定号</strong></p></li><li><p>确认号为N:则表示N-1序号的数据都已经收到</p></li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-Jf4uZN.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>数据偏移</strong>：</p><ul><li>占4位:0~15，单位为:32位字</li><li>数据偏离首部的距离</li></ul><p><strong>TCP标记</strong>：</p><ul><li>占6位，每位各有不同的意义</li></ul><table><thead><tr><th>标记</th><th>含义</th></tr></thead><tbody><tr><td>URG</td><td>Urgent: 紧急位，URG=1，表示紧急数据</td></tr><tr><td>ACK</td><td>Acknowledgement: 确认位，ACK=1，确认号才生效</td></tr><tr><td>PSH</td><td>Push: 推送位，PSH=1，尽快地把数据交付给应用层</td></tr><tr><td>RST</td><td>Reset: 重置位，RST=1，重新建立连接</td></tr><tr><td>SYN</td><td>Synchronization: 同步位，SYN=1 表示连接请求报文</td></tr><tr><td>FIN</td><td>Finish: 终止位，FIN=1 表示释放连接</td></tr></tbody></table><p><strong>窗口</strong>：</p><ul><li>占16位:0~2<sup>16</sup>-1</li><li>窗口指明允许对方发送的数据量 【流量控制】</li></ul><p><strong>紧急指针</strong>：</p><ul><li><p>紧急数据（URG = 1）</p></li><li><p>指定紧急数据在报文的位置</p></li></ul><p><strong>TCP选项</strong>：</p><ul><li>最多40字节<ul><li>因为TCP报文最多60字节，其中TCP首部最少20字节</li></ul></li><li>支持未来的拓展</li></ul><h3 id="5-可靠传输基本原理">5.可靠传输基本原理</h3><h4 id="1）停止等待协议">1）停止等待协议</h4><h5 id="1-内容">&lt;1&gt;内容</h5><ul><li>无差错情况</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-NzsUYk.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ul><li><p>发送的消息丢失</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-XRbIuv.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p>确认消息丢失<img src="https://hutu.aimtao.net/mark/2020-02-29-XSn1lq.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li><li><p>确认消息很久才到<img src="https://hutu.aimtao.net/mark/2020-02-29-0FNFyl.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul><h5 id="2-超时计时器">&lt;2&gt;超时计时器</h5><ul><li><p>遇到丢失问题则<strong>超时重传</strong></p></li><li><p><strong>【超时定时器】</strong>：每发送一个消息，都需要设置一个定时器</p></li></ul><h5 id="3-特点">&lt;3&gt;特点</h5><ul><li>停止等待协议是最简单的可靠传输协议</li><li>停止等待协议对 <strong>信道的利用效率</strong> 不高<ul><li>发送方每发送消息，都要等待确认消息回来，没有收到确认消息就一直等待确认消息。</li></ul></li></ul><h4 id="2）连续ARQ协议">2）连续ARQ协议</h4><ul><li>ARQ(Automatic Repeat reQuest:自动重传请求)</li></ul><h5 id="1-滑动窗口">&lt;1&gt;滑动窗口</h5><ol><li>发送1~6报文</li><li>当收到1、2的确认消息</li><li>将窗口向前滑动</li><li>发送7、8两个报文</li></ol><p><img src="https://hutu.aimtao.net/mark/2020-02-29-naarIL.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h5 id="2-累计确认">&lt;2&gt;累计确认</h5><ol><li>发送到1～6报文</li><li>若收到 5 的确认消息（如果1、2、3、4有丢报情况，不会发送 5 的确认报文）</li><li>说明1～5报文都已确认</li><li>向前滑动，发送其他报文</li></ol><p><img src="https://hutu.aimtao.net/mark/2020-02-29-rh9Tmh.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="3）TCP的可靠传输">3）TCP的可靠传输</h4><ul><li>TCP的可靠传输基于连续ARQ协议</li><li>TCP的滑动窗口以<strong>字节</strong>为单位</li></ul><h5 id="1-理想情况">&lt;1&gt;理想情况</h5><p><img src="https://hutu.aimtao.net/mark/2020-02-29-Vjazg2.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h5 id="2-可用窗口-0情况">&lt;2&gt;可用窗口=0情况</h5><p><img src="https://hutu.aimtao.net/mark/2020-02-29-zLtJiH.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h5 id="3-超时重传">&lt;3&gt;超时重传</h5><blockquote><p>超时了就要从头重传，比较低效。</p></blockquote><ul><li>23、24没有收到确认，25、27收到了，但接收方不能确认 25、27。</li><li>23 定时器超时，发送方不知道哪些包丢失了，只能从 23 开始全部重传。</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-UgIicl.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h5 id="4-选择重传">&lt;4&gt;选择重传</h5><blockquote><p>SACK（Selective Acknowledgment）</p><p>接收方会<strong>返回最近收到的报文段的序列号范围</strong>，这样客户端就知道，哪些数据包已经到达服务器了。</p></blockquote><p>举个例子：</p><blockquote><p>第一个报文丢失，剩下的 7 个报文都被收到了。</p><p>当收到 7 个报文的<strong>任何一个</strong>的时候，接收方会返回一个带 SACK 选项的 ack，告知发送方自己收到了哪些乱序报文。</p></blockquote><ul><li><strong>选择重传不能累积确认</strong>，和停止等待协议相同，需要逐个报文确认。</li><li>窗口内的报文，收到哪个就确认哪个（带 SACK 选项的 ack），乱序的报文将被缓存。</li><li>直到窗口内最小的序号的报文被确认（可能超时重传），才交付上层，右移滑动窗口。</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-UgIicl.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p>具体过程：</p><p><img src="https://hutu.aimtao.net/mark/2021-03-18-prFyVl.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p>其他细节：</p><ul><li><p>选择重传需要指定需要重传的字节</p></li><li><p>每一个字节都有唯一的32位序号【见 TCP中序号】</p></li><li><p>重传的字节序号放在TCP选项中</p></li><li><p>因为<strong>数据偏移</strong>的最大值限制了TCP首部的长度</p><ul><li>因为加入了TCP首部，所以序号发生偏移</li><li>TCP首部最长60字节，固定长度20字节</li></ul></li><li><p>so：TCP选项最长40字节，每个序号32位，即可放10个序号</p><ul><li>序号标记<strong>一段字节</strong>的边界</li></ul></li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-dBi9Qj.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h5 id="5-快速重传">&lt;5&gt; 快速重传</h5><ul><li>超时重传中，23号报文，因为在定时器超时，还没有接受到确认报文，判断23号报文丢失，才开始重传。有没有办法在接收方发现报文丢失，就立刻进行重传呢？（比超时重传效率高）</li><li><strong>快速重传机制，实现了另外的一种丢包评定标准，即如果接收方连续收到3次dup ack = 23报文的序号，发送方就认为这个 seq 的包（23号报文）丢失了，立刻进行重传。</strong></li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-UgIicl.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="4）综合举例">4）综合举例</h4><p>【报文丢失】</p><ul><li>发送方发送 1、2、3 号报文。接收方收到 2、3 号报文。</li><li>此时是不会对 2、3 号报文进行确认的。2、3 号报文放入缓冲区（等待累积确认）不交付给上层。</li></ul><p>【快速重传】（此处换成超时重传也可以）</p><ul><li>根据TCP协议的规定，<strong>当接收方收到乱序片段时，需要重复发送 ack = 1号报文序号</strong>，表示 ack 以前的都收到了，ack 之后的还未收到。</li><li>发送方可能还会继续发送 4 号报文。接收方再次重复发送 ack = 1号报文序号。当发送方收到三次重复报文，便认为该报文丢失，进行 <strong>快速重传</strong>。</li></ul><p>【累积确认】</p><ul><li>接收方收到快速重传的 1 号报文，此时才对 1、2、3、4 号报文进行确认，并交付给上层。只需要回复 ack = 4 号报文序号 + 1 即可表示，前面的报文都收到了。</li></ul><h3 id="6-流量控制">6.流量控制</h3><ul><li>流量控制指让发送方发送速率不要太快</li><li>流量控制是使用滑动窗口来实现的</li></ul><p><strong>具体时间轴</strong>：</p><ul><li>seq：序号</li><li>ACK=1：确认号有效</li><li>ACK=0：报文中不包含确认信息，忽略确认号字段</li><li>ack：确认号（确认号之前的数据已经收到）</li><li>rwnd：窗口</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-jXDZTT.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="1）窗口">1）窗口</h4><ul><li>占16位:0~2<sup>16</sup>-1</li><li>窗口指明允许对方发送的数据量</li></ul><h4 id="2）坚持定时器">2）坚持定时器</h4><ul><li>当接收到窗口为0的消息，则启动<strong>坚持定时器</strong></li><li>坚持定时器每隔一段时间发送一个<strong>窗口探测报文</strong></li></ul><h3 id="7-拥塞控制">7.拥塞控制</h3><ul><li>一条数据链路经过非常多的设备</li><li>数据链路中各个部分都有可能成为网路传输的瓶颈</li></ul><h4 id="1）流量控制与拥塞控制区别">1）流量控制与拥塞控制区别</h4><ul><li>流量控制考虑 <strong>点对点</strong> 的通信量的控制</li><li>拥塞控制考虑 <strong>整个网络</strong> ，是全局性的考虑</li></ul><h4 id="2）拥塞的判断">2）拥塞的判断</h4><ul><li>报文超时则认为是拥塞</li><li>（报文超时不一定是拥塞，可能网络故障）</li></ul><h4 id="3）慢启动算法">3）慢启动算法</h4><ul><li>由小到大逐渐增加发送数据量</li><li>每收到一个报文确认，就加一<ul><li>数据量指数增长</li><li>1、2、4、8、16、…【增长到慢启动阈值（ssthresh）】</li></ul></li><li>到达阈值后，执行拥塞避免算法</li></ul><h4 id="4）拥塞避免算法">4）拥塞避免算法</h4><ul><li><p>维护一个拥塞窗口的变量</p></li><li><p>只要网络不拥塞，就试探着拥塞窗口调大，每次加一</p><ul><li>1、4、8、16（慢启动）</li><li>17、18、19（调大拥塞窗口）</li></ul></li></ul><blockquote><p>x轴：轮次</p><p>y轴：报文数据量</p></blockquote><p><img src="https://hutu.aimtao.net/mark/2020-02-29-PEjGya.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="8-TCP连接的建立">8.TCP连接的建立</h3><h4 id="1）TCP标记">1）TCP标记</h4><ul><li>占6位，每位各有不同的意义</li></ul><table><thead><tr><th>标记</th><th>含义</th></tr></thead><tbody><tr><td>URG</td><td>Urgent: 紧急位，URG=1，表示紧急数据</td></tr><tr><td>==ACK==</td><td>==Acknowledgement: 确认位，ACK=1，确认号才生效==</td></tr><tr><td>PSH</td><td>Push: 推送位，PSH=1，尽快地把数据交付给应用层</td></tr><tr><td>RST</td><td>Reset: 重置位，RST=1，重新建立连接</td></tr><tr><td>==SYN==</td><td>==Synchronization: 同步位，SYN=1 表示连接请求报文==</td></tr><tr><td>==FIN==</td><td>==Finish: 终止位，FIN=1 表示释放连接==</td></tr></tbody></table><h4 id="2）连接建立">2）连接建立</h4><p><img src="https://hutu.aimtao.net/mark/2020-02-29-IWeV4Y.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ul><li>seq：序号</li><li>SYN：连接请求</li><li>ACK=1：确认号生效</li><li>ack：确认号（ack 之前的都收到了）</li></ul><p><strong>三次握手</strong>：</p><ol><li>【发送方】发送连接请求（SYN=1）、报文序号（seq）</li><li>【接受方】被动建立连接，发送连接请求（SYN=1）、反馈确认号有效（ACK=1）、期待下次接收的序号（ack=x+1）、自己数据报的序号（seq）</li><li>【发送方】反馈确认号有效（ACK=1）、期待下次接收的序号（ack=y+1）、自己数据报的序号（seq）</li></ol><h4 id="3）为什么要三次握手">3）为什么要三次握手</h4><ul><li>已经失效的连接请求报文传送到对方，引起错误</li></ul><ol><li>失效的请求报文，发送很久才到达接收方</li></ol><p><img src="https://hutu.aimtao.net/mark/2020-02-29-63dpDg.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ol start="2"><li>接收方收到失效的请求报文，并回应发送方，此时发送方建立连接</li></ol><p><img src="https://hutu.aimtao.net/mark/2020-02-29-gmk7a5.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ol start="3"><li><p>如果只握手两次，那么失效的请求报文也会建立连接</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-1JMmct.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ol><ul><li>对于发送方，接收到接收方的回应就可以建立连接</li><li>对于接收方，接收到发送的回应才算建立连接</li></ul><h3 id="9-TCP连接的释放">9.TCP连接的释放</h3><h4 id="1）四次挥手（四次释放）">1）四次挥手（四次释放）</h4><p><img src="https://hutu.aimtao.net/mark/2020-02-29-2710jB.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><ul><li>FIN=1：表示释放连接</li></ul><p><strong>过程</strong>：</p><ol><li>发送方发送“释放连接”（FIN=1）、报文序号（seq）</li><li>接收方收到FIN=1后，确认收到序号（ACK=1）（表示已经收到”释放连接“）、报文序号</li><li>关闭等待期间，还可以进行数据传输。<ul><li>因为释放连接请求是发送方发出来的，说明发送方已发送完数据</li><li>但是接收方不一定发送完数据，所以关闭等待期间是用来给发送方传输数据的</li></ul></li><li>接收方数据发送结束后，发送“释放连接”（FIN=1）、并重复对第一次的序号进行确认（ACK=1）、</li><li>发送方发送ACK=1，表示已收到接收方连接释放信号</li></ol><h4 id="2）等待计时器">2）等待计时器</h4><blockquote><p>主动释放连接的一方，端口被占用</p></blockquote><p><strong>2MSL</strong></p><ul><li><p>MSL(Max Segment Lifetime): 最长报文段寿命</p></li><li><p>MSL建议设置为2分钟</p></li></ul><p><strong>为什么需要等待2MSL?</strong></p><ul><li>为了确保发送方的ACK可以到达接收方<ul><li>不是为了确认报文，因为最后一个报文没有确认</li><li>2MSL时间内没有收到，则接收方会重发【报文在网络中最长存活时间】</li></ul></li><li>确保当前连接的所有报文【之前的】都已经过期。【超过最长存活时间】</li></ul><h3 id="10-TCP状态转换图">10.TCP状态转换图</h3><blockquote><p>实线：主动连接、主动关闭的一端。</p><p>虚线：被动连接、被动关闭的一端。</p><p>细线：主动端和被动端同时发送。</p></blockquote><p><img src="https://hutu.aimtao.net/mark/2021-03-22-Uvfpxc.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>CLOSED</strong>：初始状态。</p><p><strong>LISTEN</strong>：服务器端某个SOCKET处于监听状态，可以接受连接。</p><p><strong>SYN_SENT</strong>：这个状态与SYN_RCVD遥相呼应，客户端已发送SYN报文，等待服务器回复 SYN、ACK。</p><p><strong>SYN_RCVD:</strong> 接收 SYN 并回复 SYN、ACK，等待客户端回复 ACK（三次握手的最后一个报文）。<font color="#9A9A9A"> 在正常情况下，这个状态是服务器端的SOCKET在建立TCP连接时的三次握手会话过程中的一个中间状态，很短暂。</font> 此种状态时，当收到客户端的ACK报文后，会进入到ESTABLISHED状态。</p><p><strong>ESTABLISHED</strong>：连接已经建立。</p><blockquote><p>FIN_WAIT_1和FIN_WAIT_2 都是等待对方的FIN报文。区别在于：</p></blockquote><p><strong>FIN_WAIT_1</strong>：当 socket 在 ESTABLISHED 状态时，想主动关闭连接，向对方发送了 FIN 报文后，该 socket 进入到 FIN_WAIT_1 状态。<font color="#9A9A9A">如果FIN_WAIT_1状态下，收到对方同时带 FIN 标志和 ACK 标志的报文时，可以直接进入到 TIME_WAIT 状态，而无须经过 FIN_WAIT_2 状态。</font></p><p><strong>FIN_WAIT_2</strong>：当对方回应ACK后，该 socket 进入到 FIN_WAIT_2 状态。<font color="#9A9A9A">正常情况下，对方应马上回应ACK报文，所以FIN_WAIT_1状态一般较难见到，</font> FIN_WAIT_2 状态可用 netstat 看到。<strong>称之为半连接或半关闭状态</strong>。该状态下的socket只能接收数据，不能发。</p><p><strong>TIME_WAIT:</strong> 收到了对方的FIN报文，并发送出了 ACK 报文，等 2MSL 后即可回到 CLOSED 可用状态。</p><p><strong>CLOSING:</strong> 这种状态较特殊，属于一种较罕见的状态。正常情况下，当你发送FIN报文后，按理来说是应该先收到（或同时收到）对方的 ACK报文，再收到对方的FIN报文。但是CLOSING状态表示你发送FIN报文后，并没有收到对方的ACK报文，反而却也收到了对方的FIN报文。什么情况下会出现此种情况呢？如果双方几乎在同时close一个SOCKET的话，那么就出现了双方同时发送FIN报文的情况，也即会出现CLOSING状态，表示双方都正在关闭SOCKET连接。</p><p><strong>CLOSE_WAIT:</strong> 表示在等待关闭。当对方关闭一个 socket 后发送 FIN 报文给自己，系统会回应一个 ACK 报文给对方，此时则进入到 CLOSE_WAIT 状态。接下来，查看是否还有数据发送给对方，如果没有可以 close这个 socket，发送 FIN 报文给对方，即关闭连接。所以在 CLOSE_WAIT 状态下，需要关闭连接。</p><p><strong>LAST_ACK:</strong> 该状态是被动关闭一方在发送 FIN 报文后，最后等待对方的 ACK 报文。当收到 ACK 报文后，即可以进入到 CLOSED 可用状态。</p><p><strong>问题自测</strong>：</p><ol><li><p>为什么连接要三次握手，释放却需要四次挥手？</p><p>因为释放时，允许<strong>半关闭</strong>状态（FIN_WAIT_2）。相当于将 <strong>三次握手的第二次报文（ACK+SYN）</strong> 拆成了 <strong>四次挥手的第二三次报文（ACK，FIN）</strong>。</p></li><li><p>什么是半关闭状态？</p><p>主动关闭方，只能接受不能发送数据；被动关闭方可以发送数据。</p></li><li><p>最后一次 ACK 是谁发的？</p><p>主动关闭方发送的 ACK（确认被动关闭方的 FIN 报文）。</p></li><li><p>为什么需要 TIME_WAIT 状态？</p><p>确保被动关闭方，可以收到主动关闭方的最后一次 ACK 应答（确认被动关闭方的 FIN 报文）。</p><p>如果被动关闭方没有收到 ACK 应答，会超时重传 FIN 报文。</p><p>主动关闭方又收到了 FIN 报文，则表示最后一次 ACK 应答丢失。在 2MSL 时间内重传 ACK。（MSL：Maximum Segment Lifetime）</p></li></ol><h3 id="11-套接字和套接字编程">11.套接字和套接字编程</h3><ul><li>使用端口(Port)来标记不同的网络进程</li><li>端口(Port)使用16比特位表示(0~65535)</li></ul><h4 id="1）套接字：-IP-Port">1）套接字：{IP:Port}</h4><ul><li>套接字(Socket)是抽象概念，表示TCP连接的一端</li><li>通过套接字可以进行数据发送或接收</li></ul><p><strong>TCP连接由两个套接字组成</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">TCP<br>=&#123;Socket1:Socket2&#125;<br>=&#123;&#123;IP:Port&#125;&#123;IP:Port&#125;&#125;<br></code></pre></td></tr></table></figure><h4 id="2）套接字编程">2）套接字编程</h4><p><strong>服务端</strong>：</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-kpBelz.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>客户端</strong>：</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-Ho6v1T.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="3）网络套接字和域套接字">3）网络套接字和域套接字</h4><p>网络套接字：要经过协议栈</p><p>域套接字：使用域套接字文件传输，适合单机通讯</p><h2 id="九、应用层">九、应用层</h2><blockquote><p>会话层、表示层、应用层</p></blockquote><h3 id="1-概述">1.概述</h3><ul><li>传输层以及以下的层提供完整的通信服务</li><li>应用层是面向用户的一层</li></ul><h4 id="1）常见的应用层协议">1）常见的应用层协议</h4><table><thead><tr><th>FTP</th><th>http</th><th>HTTPS</th><th>DNS</th><th>TELNET</th></tr></thead><tbody><tr><td>21</td><td>80</td><td>443</td><td>53</td><td>23</td></tr></tbody></table><h4 id="2）UDP和TCP的应用层服务">2）UDP和TCP的应用层服务</h4><p>UDP：【多媒体信息分发】视频、语音、实时信息（股票走势）</p><p>TCP：【可靠消息传输】金融交易、可靠通讯、MQ</p><h3 id="2-DNS详解">2.DNS详解</h3><ul><li><p>DNS（Domain Name System：域名系统）</p><ul><li>域：网络段</li><li>名：个体的名字</li></ul></li><li><p>使用域名帮助记忆</p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-NAQ1qI.webp-s" srcset="/img/loading.gif" lazyload alt=""></p></li></ul><h4 id="1）格式">1）格式</h4><ul><li><p>域名由点、字母和数字组成</p></li><li><p>点分割不同的域</p></li><li><p>域名可以分为顶级域、二级域、三级域</p></li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-V2LJTF.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-6cdYZf.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><img src="https://hutu.aimtao.net/mark/2020-02-29-5vpQFB.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h4 id="2）域名服务器">2）域名服务器</h4><ol><li>根域名服务器：知道所有顶级域名服务器的域名和IP，由各国和地区来维护</li><li>顶级域名服务器：由国家和地区来维护</li><li>域名服务器：由公司或者机构来维护</li></ol><p><img src="https://hutu.aimtao.net/mark/2020-02-29-rMeWhe.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="2-DHCP协议">2.DHCP协议</h3><ul><li>DHCP(Dynamic Host Configuration Protocol: 动态主机设置协议)</li><li>DHCP是一个局域网协议</li><li>DHCP是应用UDP协议的应用层协议</li></ul><h4 id="1）功能">1）功能</h4><ul><li><p>即插即用联网</p><ul><li><p>自动分配临时IP</p></li><li><p>临时IP有租期存在</p><p>​</p></li></ul></li></ul><h4 id="2）过程">2）过程</h4><ul><li>DHCP服务器监听默认端口:67</li><li>主机使用UDP协议广播 <strong>DHCP发现报文</strong></li><li>DHCP服务器发出 <strong>DHCP提供报文</strong></li><li>主机向DHCP服务器发出 <strong>DHCP请求报文</strong></li><li>DHCP服务器回应并提供IP地址</li></ul><p><img src="https://hutu.aimtao.net/mark/2020-02-29-LjI5l8.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><h3 id="3-HTTP协议">3.HTTP协议</h3><ul><li>HTTP(HyperText Transfer Protocol: 超文本传输协议)</li></ul><h4 id="1）地址">1）地址</h4><ul><li><p>http(s)://&lt;主机&gt;:&lt;端口&gt;/&lt;路径&gt;</p><ul><li>端口：80</li><li>安全端口：443</li></ul></li><li><p>例：<a href="https://www.aimtao.net/">https://www.aimtao.net/</a></p></li></ul><h4 id="2）可靠的数据传输协议">2）可靠的数据传输协议</h4><ul><li><p>HTTP协议是可靠的数据传输协议</p></li><li><p>数据：文本、图片、音频、视频、文件、动图、（web内容）</p></li></ul><h4 id="3）web服务器">3）web服务器</h4><p>硬件部分：计算机、虚拟服务器</p><p>软件部分：Apacha</p><h4 id="4）过程">4）过程</h4><ol><li>接受客户端连接</li><li>接受请求报文</li><li>处理请求</li><li>访问web资源</li><li>构造应答</li><li>发送应答</li></ol><h4 id="5）请求方法">5）请求方法</h4><ul><li>GET：获取制定服务器资源</li><li>POST：提交数据到服务器</li><li>DELETE：删除指定的服务端资源</li><li>UPDATA：更新指定的服务端资源</li><li>PUT</li><li>OPTIONS</li><li>PATCH</li><li>HEAD</li><li>TRACE</li></ul><h4 id="6）指定资源">6）指定资源</h4><p>在地址中指定资源</p><ul><li>https:// <a target="_blank" rel="noopener" href="http://xxx.com/class/355.html">xxx.com/class/355.html</a><ul><li>class/355.html：第355个课程</li></ul></li><li>https:// <a target="_blank" rel="noopener" href="http://xxx.com/?sort=0&amp;unlearn=0&amp;page=2">xxx.com/?sort=0&amp;unlearn=0&amp;page=2</a><ul><li>sort=0：不排序</li><li>unlearn=0：不显示未学习</li><li>pge=2：第二页</li></ul></li></ul><h4 id="7）请求报文与应答报文">7）请求报文与应答报文</h4><p><img src="https://hutu.aimtao.net/mark/2020-02-29-yhjnI5.webp-s" srcset="/img/loading.gif" lazyload alt=""></p><p><strong>请求报文的请求内容</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 请求内容</span><br>POST https://coding.imooc.com HTTP/<span class="hljs-number">1.1</span><br>Accept-Encoding: gzip <br>Accept-Language: zh-CN<br>&#123;<br><span class="hljs-string">&quot;sort&quot;</span>: <span class="hljs-number">0</span>,<br><span class="hljs-string">&quot;unlearn&quot;</span>: <span class="hljs-number">0</span>,<br><span class="hljs-string">&quot;page&quot;</span>: <span class="hljs-number">2</span> &#125;<br></code></pre></td></tr></table></figure><p><strong>状态码</strong></p><table><thead><tr><th>状态码</th><th>含义</th></tr></thead><tbody><tr><td>200-299</td><td>成功状态码</td></tr><tr><td>300-399</td><td>重定向状态码</td></tr><tr><td>400-499</td><td>客户端错误状态码</td></tr><tr><td>500-599</td><td>服务端错误状态码</td></tr></tbody></table><h2 id="十、补充">十、补充</h2><h3 id="1-二层交换机与三层交换机">1.二层交换机与三层交换机</h3><p><strong>什么是交换机（Switch）？</strong></p><ul><li>交换机是基于 MAC 地址传输的。</li><li>要求在同一网段。</li><li>比如：计算机 A、B 均用网线连接在同一台交换机上。</li></ul><p><strong>什么是二层交换机？</strong></p><ul><li>交换机是基于MAC地址转发的，只支持物理层和数据链路层协议，所以叫二层交换机。</li></ul><p><strong>什么是三层交换机？</strong></p><ul><li>支持物理层、数据链路层、网络层协议。</li><li>带有路由功能。</li></ul><p><strong>三层交换机（Switch）和路由器（Router）的区别？</strong></p><ul><li><p>路由器是基于 IP 转发的。</p></li><li><p>三层交换机具有 MAC 地址表和 IP 路由表。所以不仅可以处理 VLAN 内通信，还可以处理不同 VLAN 之间的数据包路由。</p></li></ul><p><strong>为什么需要三层交换机？</strong></p><ul><li>三层交换机功能是加快大型局域网络内部的数据的快速转发。</li><li>如果使用二层交换机，不同网段之间无法转发（公司不同部门设置不同的小局域网）。</li><li>如果使用路由器，由于接口数量有限和路由转发速度慢，将限制网络的速度和网络规模。</li></ul><script type="text/javascript">!function(l){[].forEach.call(l.getElementsByClassName("fold"),(function(l){l.getElementsByClassName("fold-title")[0].onclick=function(){l.classList.toggle("collapsed"),l.classList.toggle("expanded")}}))}(document)</script></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/Mark/" class="category-chain-item">Mark</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Network/">#Network</a></div></div><div class="license-box my-3"><div class="license-title"><div>学习笔记｜计算机网络</div><div>https://www.aimtao.net/computer-network/</div></div><div class="license-meta"><div class="license-meta-item license-meta-date"><div>Posted on</div><div>2019-10-09</div></div><div class="license-meta-item"><div>Licensed under</div><div><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - Attribution"><i class="iconfont icon-by"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - Non-commercial"><i class="iconfont icon-nc"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - Share-alike"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/c-plus-plus/" title="学习笔记｜C++"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">学习笔记｜C++</span> <span class="visible-mobile">Previous</span></a></article><article class="post-next col-6"><a href="/mysql/" title="学习笔记｜MySQL"><span class="hidden-mobile">学习笔记｜MySQL</span> <span class="visible-mobile">Next</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments"><div id="valine"></div><style>.v[data-class=v] .veditor{background-image:url(https://hutu0.aimtao.net/foot/drinkwater.webp);background-size:contain;background-repeat:no-repeat;background-position:right;resize:none}</style><script type="text/javascript">Fluid.utils.loadComments("#valine",(function(){Fluid.utils.createScript("https://cdn.staticfile.org/valine/1.4.18/Valine.min.js",(function(){var e=Object.assign({appId:"Lwz6D7d9XSdSYpjixPxukzhF-gzGzoHsz",appKey:"UhkN5uCsv1zxjYO6nJ7vOjpB",path:"window.location.pathname",placeholder:"本站支持评论邮件提醒功能，在上方输入邮箱，即可收到回复通知！（支持 markdown 语法）",avatar:"robohash",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!0,serverURLs:"https://valine.aimtao.net",emojiCDN:"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/",emojiMaps:{666:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/6c/2022_666_org.png","微笑":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e3/2018new_weixioa02_org.png","可爱":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/09/2018new_keai_org.png","太开心":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/1e/2018new_taikaixin_org.png","鼓掌":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/2018new_guzhang_org.png","嘻嘻":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/33/2018new_xixi_org.png","哈哈":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/2018new_haha_org.png","笑cry":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/4a/2018new_xiaoku_thumb.png","挤眼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/43/2018new_jiyan_org.png","馋嘴":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/2018new_chanzui_org.png","黑线":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a3/2018new_heixian_org.png","汗":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/28/2018new_han_org.png","挖鼻":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9a/2018new_wabi_thumb.png","哼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/2018new_heng_org.png","怒":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/f6/2018new_nu_org.png","委屈":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/2018new_weiqu_org.png","可怜":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/96/2018new_kelian_org.png","失望":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/aa/2018new_shiwang_org.png","悲伤":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/ee/2018new_beishang_org.png","泪":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/2018new_leimu_org.png","允悲":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/83/2018new_kuxiao_org.png","苦涩":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/2021_bitter_org.png","害羞":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c1/2018new_haixiu_org.png","污":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/10/2018new_wu_org.png","爱你":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/f6/2018new_aini_org.png","亲亲":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/2c/2018new_qinqin_org.png","抱一抱":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/2020_hug_org.png","色":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/2018new_huaxin_org.png","憧憬":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/2018new_chongjing_org.png","舔屏":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3e/2018new_tianping_org.png","哇":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3d/2022_wow_org.png","坏笑":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/4d/2018new_huaixiao_org.png","阴险":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/2018new_yinxian_org.png","笑而不语":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/2d/2018new_xiaoerbuyu_org.png","偷笑":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/2018new_touxiao_org.png","酷":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/2018new_ku_org.png","并不简单":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/aa/2018new_bingbujiandan_org.png","思考":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/30/2018new_sikao_org.png","疑问":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/b8/2018new_ningwen_org.png","费解":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/2a/2018new_wenhao_org.png","晕":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/07/2018new_yun_org.png","衰":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a2/2018new_shuai_org.png","骷髅":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a1/2018new_kulou_org.png","嘘":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/b0/2018new_xu_org.png","闭嘴":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/2018new_bizui_org.png","傻眼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/2018new_shayan_org.png","裂开":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/202011_liekai_org.png","感冒":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/2022_cold_org.png","吃惊":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/2018new_chijing_org.png","吐":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/08/2018new_tu_org.png","生病":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3b/2018new_shengbing_org.png","拜拜":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/fd/2018new_baibai_org.png","鄙视":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/da/2018new_bishi_org.png","白眼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/ef/2018new_landelini_org.png","左哼哼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/43/2018new_zuohengheng_org.png","右哼哼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c1/2018new_youhengheng_org.png","抓狂":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/2018new_zhuakuang_org.png","怒骂":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/87/2018new_zhouma_org.png","打脸":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/2018new_dalian_org.png","顶":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/ae/2018new_ding_org.png","互粉":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/86/2018new_hufen02_org.png","钱":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a2/2018new_qian_org.png","哈欠":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/55/2018new_dahaqian_org.png","困":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3c/2018new_kun_org.png","睡":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e2/2018new_shuijiao_thumb.png","赢牛奶":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9c/2021_yingniunai_org.png","开学季":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/72/2021_kaixueji_org.png","求饶":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/aa/moren_qiurao02_org.png","吃瓜":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/01/2018new_chigua_org.png","打call":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/39/moren_dacall02_org.png",awsl:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/moren_awsl02_org.png","彩虹屁":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/4b/2022_praise_org.png","酸":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/b3/hot_wosuanle_org.png",doge:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a1/2018new_doge02_org.png","二哈":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/22/2018new_erha_org.png","喵喵":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/7b/2018new_miaomiao_org.png","单身狗":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/20/2021_alongdog_org.png","揣手":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/2022_chuaishou_org.png","举手":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/fd/2022_raisehand_org.png","抱抱":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/42/2018new_baobao_org.png","摊手":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/2018new_tanshou_org.png","跪了":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/75/2018new_gui_org.png","握手":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/2018new_woshou_org.png","赞":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e6/2018new_zan_org.png",good:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/8a/2018new_good_org.png","弱":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3d/2018new_ruo_org.png","耶":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/2018new_ye_org.png","拳头":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/86/2018new_quantou_org.png",ok:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/45/2018new_ok_org.png","加油":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9f/2018new_jiayou_org.png","作揖":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e7/2018new_zuoyi_org.png",haha:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/1d/2018new_hahashoushi_org.png","鲜花":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/2018new_xianhua_org.png","杰瑞":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/da/2021_jerry_org.png","汤姆":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/31/2021_tom_org.png","tvgif-白眼":"https://i0.hdslb.com/bfs/emote/48f75163437445665a9be80bb316e4cb252c5415.gif","tvgif-doge":"https://i0.hdslb.com/bfs/emote/302d6c88c63ed162c81a49cafe7ed2709e6fb955.gif","tvgif-坏笑":"https://i0.hdslb.com/bfs/emote/5d2572efd09aab5dde9e2a198bb3f9ac1e2a982e.gif","tvgif-难过":"https://i0.hdslb.com/bfs/emote/9c6b41008a67755410f712334c64313df5f91b3f.gif","tvgif-生气":"https://i0.hdslb.com/bfs/emote/1902a5a2df5b5c931d88c12f0feb264b1e109d0d.gif","tvgif-委屈":"https://i0.hdslb.com/bfs/emote/af5a5853edb43a8178a8cb5df707fa5e88143699.gif","tvgif-斜眼笑":"https://i0.hdslb.com/bfs/emote/c66568b471192ca1f62f6ed4384dc1b283ab7508.gif","tvgif-呆":"https://i0.hdslb.com/bfs/emote/d3fa91e4db9215eb1e20ab9da44f1214aa4bda7b.gif","tvgif-发怒":"https://i0.hdslb.com/bfs/emote/3959eb81b952e4fa8d269d98f9e3639172d84073.gif","tvgif-惊吓":"https://i0.hdslb.com/bfs/emote/13549060757fcd92b11d0657d9b3b6038f97abb6.gif","tvgif-呕吐":"https://i0.hdslb.com/bfs/emote/db58e9442aae26694af18cc1683607cca3a16763.gif","tvgif-思考":"https://i0.hdslb.com/bfs/emote/b63f9146bfd985af014f8d6d4bdb498805be48f9.gif","tvgif-微笑":"https://i0.hdslb.com/bfs/emote/b98656855d782f61cb8edc7f7fca6563ecafff7e.gif","tvgif-疑问":"https://i0.hdslb.com/bfs/emote/fce1b1a0f3b0e39a2dc16a18508dba7b91e929f4.gif","tvgif-大哭":"https://i0.hdslb.com/bfs/emote/cba61f05f3039b02a7ffc0dfcd9d7995df9fdd74.gif","tvgif-鼓掌":"https://i0.hdslb.com/bfs/emote/be106e6b265883a9f28fbe10f7b765701e2618d4.gif","tvgif-抠鼻":"https://i0.hdslb.com/bfs/emote/696d9f93e722144dc2a78aeffc569418fdf3d565.gif","tvgif-亲亲":"https://i0.hdslb.com/bfs/emote/3534ea44ab74bd20352b88c245a06c4b4c46d271.gif","tvgif-调皮":"https://i0.hdslb.com/bfs/emote/fcd967395fd14e4dd5829fa7e8a967ce23205e52.gif","tvgif-笑哭":"https://i0.hdslb.com/bfs/emote/1c2fd1e8c9dde12812f86e5d4cbddd8993d98082.gif","tvgif-晕":"https://i0.hdslb.com/bfs/emote/030040ec5c9ddc9e3d067658c4139e7314ab42f8.gif","tvgif-点赞":"https://i0.hdslb.com/bfs/emote/30ecff401245fb56bcc1cf588d1809ac1ab1607c.gif","tvgif-害羞":"https://i0.hdslb.com/bfs/emote/411a3e459e8580f5bfd9f639a408247c4b509935.gif","tvgif-睡着":"https://i0.hdslb.com/bfs/emote/3c8b5e293261287a6203597e29b3de07df4d18c6.gif","tvgif-色":"https://i0.hdslb.com/bfs/emote/a0c6d99ab0ab63b8648f5283ff72cec04b604828.gif","tvgif-吐血":"https://i0.hdslb.com/bfs/emote/e17e4539e169d14a3389ff147afea760cebe5de5.gif","tvgif-无奈":"https://i0.hdslb.com/bfs/emote/eb4cb5f07cfd177c7e6a7914316717e56d9cc1d0.gif","tvgif-再见":"https://i0.hdslb.com/bfs/emote/344f61609ecce2008520dc8a977b6169215748a9.gif","tvgif-流汗":"https://i0.hdslb.com/bfs/emote/390bccec65eaff536bd5bb2a0c5b8b0bdea47334.gif","tvgif-偷笑":"https://i0.hdslb.com/bfs/emote/7f11e6f7f63e79112b833bd41fa13a83d7cd8474.gif","tvgif-抓狂":"https://i0.hdslb.com/bfs/emote/a476b93ecd8e94ac3257323fd822f91cef212de2.gif","tvgif-黑人问号":"https://i0.hdslb.com/bfs/emote/b609adf664be33224a9923262031165ae3e34cd2.gif","tvgif-困":"https://i0.hdslb.com/bfs/emote/91c2bf34ecf842d7016c01d841db3d4074bd281f.gif","tvgif-打脸":"https://i0.hdslb.com/bfs/emote/b0fad4856e59c1240e448437da3287bb5ce547e5.gif","tvgif-闭嘴":"https://i0.hdslb.com/bfs/emote/a3fc5388b09e945be3f18fe23bfed5874a0285b7.gif","tvgif-鄙视":"https://i0.hdslb.com/bfs/emote/293b5d459e6264ecf314d20937a936fa672ccd1e.gif","tvgif-腼腆":"https://i0.hdslb.com/bfs/emote/30984e8264324f901d19bea85dada7103b695534.gif","tvgif-馋":"https://i0.hdslb.com/bfs/emote/2525c5703c594e5f0752f68db8948773caebde47.gif","tvgif-可爱":"https://i0.hdslb.com/bfs/emote/f92d20f76258bc5f33fc9d7c5e2a1d41fef19a7c.gif","tvgif-发财":"https://i0.hdslb.com/bfs/emote/76131e52c9b033681b4c896c6024d29ef7ec7ec2.gif","tvgif-生病":"https://i0.hdslb.com/bfs/emote/beb94829fe04f1a41bd6ca611e1f6ca9ca169afa.gif","tvgif-流鼻血":"https://i0.hdslb.com/bfs/emote/8ef473f74a849420da712487b2f56ecca1f695f5.gif","tvgif-尴尬":"https://i0.hdslb.com/bfs/emote/e0b84ef5ee3e5b8978e584c7c5a6550c51d15f84.gif","tvgif-大佬":"https://i0.hdslb.com/bfs/emote/14ca0c05382b8741940942b2430b7a8d55c02f7e.gif","暹罗猫小豆泥-抱大腿":"https://i0.hdslb.com/bfs/emote/1e309b348e969e7ff1c7d873352799a2005494d5.png","暹罗猫小豆泥-不要":"https://i0.hdslb.com/bfs/emote/00d5e138feb370186c4e473061b21b42f8a3ea36.png","暹罗猫小豆泥-呆滞":"https://i0.hdslb.com/bfs/emote/b6ec6210f8c7095f4a14ccf8a6ec1b60fb1aa416.png","暹罗猫小豆泥-单纯":"https://i0.hdslb.com/bfs/emote/e5cdb0d44f35f545d37cbc95ca09cdb9f79ebf48.png","暹罗猫小豆泥-好耶":"https://i0.hdslb.com/bfs/emote/5fc0be80c750a057d1c068a9a3c65c7b09a49e02.png","暹罗猫小豆泥-惊讶":"https://i0.hdslb.com/bfs/emote/d6024fd52d7e66241062c045559974e2a4c6e87f.png","暹罗猫小豆泥-哭":"https://i0.hdslb.com/bfs/emote/9153d549e425cc02eb911695fff29cb59b338da0.png","暹罗猫小豆泥-来了":"https://i0.hdslb.com/bfs/emote/d5d12b9d885346de164f30d41a10f235872aaefa.png","暹罗猫小豆泥-呸":"https://i0.hdslb.com/bfs/emote/a7f7d5a13c8d1c1ff116e7362108fb49045b4b72.png","暹罗猫小豆泥-探头":"https://i0.hdslb.com/bfs/emote/4741a1d527c52365850368b2f480d5818b23cb8f.png","暹罗猫小豆泥-舔":"https://i0.hdslb.com/bfs/emote/d071edebf8d3fbad73d773e9049eee2a0c28f1d5.png","暹罗猫小豆泥-投币":"https://i0.hdslb.com/bfs/emote/77b10ddaf24b4547e712ba8ae8f8e51ca8c38bb1.png","暹罗猫小豆泥-苦鲁西":"https://i0.hdslb.com/bfs/emote/ad3b14a2a5cf6680468222581a9964577eaca3d3.png","暹罗猫小豆泥-再见":"https://i0.hdslb.com/bfs/emote/e4c72ecf403858750b881030d650769e79017561.png","暹罗猫小豆泥-震惊":"https://i0.hdslb.com/bfs/emote/7caf9631dfb93071a843e308e5382799494d3a71.png"},enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(e),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var e="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(e),Fluid.plugins.fancyBox(e)})}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><button id="floating-toc-button" class="floating-toc-button"><i class="iconfont icon-list"></i></button><div id="floating-toc" class="floating-toc"><div class="floating-toc-header"><i class="iconfont icon-list"></i></div><div class="floating-toc-body"><ul class="floating-toc-list" id="floating-toc-list"></ul></div></div><script>document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("floating-toc-button"),e=document.getElementById("floating-toc"),n=document.getElementById("floating-toc-list"),o=!1,d=0,i=0;t.addEventListener("mousedown",(function(e){o=!0,d=e.clientX-t.offsetLeft,i=e.clientY-t.offsetTop})),document.addEventListener("mousemove",(function(e){o&&(t.style.left=e.clientX-d+"px",t.style.top=e.clientY-i+"px")})),document.addEventListener("mouseup",(function(){o=!1})),t.addEventListener("touchstart",(function(e){o=!0,d=e.touches[0].clientX-t.offsetLeft,i=e.touches[0].clientY-t.offsetTop})),document.addEventListener("touchmove",(function(e){o&&(t.style.left=e.touches[0].clientX-d+"px",t.style.top=e.touches[0].clientY-i+"px")})),document.addEventListener("touchend",(function(){o=!1})),t.addEventListener("click",(function(){e.classList.toggle("active")})),document.querySelectorAll(".markdown-body h1, .markdown-body h2, .markdown-body h3, .markdown-body h4, .markdown-body h5, .markdown-body h6").forEach((function(t){var o=parseInt(t.tagName.charAt(1)),d=document.createElement("li"),i=document.createElement("a");i.classList.add("floating-toc-link"),i.textContent=t.textContent,i.setAttribute("href","#"+t.getAttribute("id")),d.classList.add("floating-toc-list-item"),d.classList.add("level-"+o),d.appendChild(i),n.appendChild(d),i.addEventListener("click",(function(n){n.preventDefault();var o=t.getAttribute("id"),d=document.getElementById(o),i=document.getElementsByClassName("header-inner")[0];if(d&&i){var c=window.pageYOffset,a=d.offsetTop+i.offsetHeight-c,s=null;window.requestAnimationFrame((function t(e){s||(s=e);var n,o=e-s,d=Math.min(o/1e3,1),i=(n=d)<.5?2*n*n:(4-2*n)*n-1;window.scrollTo(0,c+a*i),o<1e3&&window.requestAnimationFrame(t)}))}e.classList.remove("active")}))}))}))</script><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">Search</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">Keyword</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="statistics"><span id="leancloud-site-pv-container" style="display:none"><i class="iconfont iconPV"></i> <span id="leancloud-site-pv"></span> </span><span id="leancloud-site-uv-container" style="display:none"><i class="iconfont iconUV"></i> <span id="leancloud-site-uv"></span></span></div><div class="beian"><span><i class="iconfont iconICP-13"></i> <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">鄂 ICP 备 20000502 号</a></span></div><div class="footer-content"><a href="https://www.aimtao.net/categories/Mark/" rel="nofollow noopener"><span id="aimtao">© 2025 AimTao </span></a><i class="iconfont icon-love"></i> <span id="timeDate">loading...</span> <span id="times">loading...</span><script>var now=new Date;function createtime(){var n=new Date("11/28/2018 15:28:05");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="&nbsp"+dnum+"&nbsp天",document.getElementById("times").innerHTML=hnum+"&nbsp小时&nbsp"+mnum+"&nbsp分&nbsp"+snum+"&nbsp秒"}setInterval("createtime()",250)</script></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script defer>if(!Fluid.ctx.dnt){var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?07fe5d228ae82eadee00480515f9d64b";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var o=jQuery("#board-ctn").offset().top;window.tocbot.init({tocSelector:"#toc-body",contentSelector:".markdown-body",headingSelector:CONFIG.toc.headingSelector||"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:CONFIG.toc.collapseDepth||0,scrollSmooth:!0,headingsOffset:-o}),t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))</script><script>!function(){var e=CONFIG.code_language.enable&&CONFIG.code_language.default,a=CONFIG.copy_btn;if(e||a){var i="";i+='<div class="code-widget">',i+="LANG",i+="</div>",jQuery(".markdown-body pre").each((function(){var n=jQuery(this);if(!(n.find("code.mermaid").length>0||n.find("span.line").length>0)){var t,c="";e&&(c=CONFIG.code_language.default,n[0].children.length>0&&n[0].children[0].classList.length>=2&&n.children().hasClass("hljs")?c=n[0].children[0].classList[1]:n[0].getAttribute("data-language")?c=n[0].getAttribute("data-language"):n.parent().hasClass("sourceCode")&&n[0].children.length>0&&n[0].children[0].classList.length>=2?(c=n[0].children[0].classList[1],n.parent().addClass("code-wrapper")):n.parent().hasClass("markdown-body")&&0===n[0].classList.length&&n.wrap('<div class="code-wrapper"></div>'),c=c.toUpperCase().replace("NONE",CONFIG.code_language.default)),n.append(i.replace("LANG",c).replace('code-widget">',(t=n[0],(Fluid.utils.getBackgroundLightness(t)>=0?"code-widget-light":"code-widget-dark")+(a?' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>':' code-widget">')))),a&&Fluid.utils.createScript("https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js",(function(){new window.ClipboardJS(".copy-btn",{target:function(e){for(var a=e.parentNode.childNodes,i=0;i<a.length;i++)if("CODE"===a[i].tagName)return a[i]}}).on("success",(function(e){e.clearSelection(),e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-copy","icon-success"),setTimeout((function(){e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-success","icon-copy")}),2e3)}))}))}}))}}()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var o=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),n=[];for(var i of o)n.push(".markdown-body > "+i.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(n.join(", "))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="/js/leancloud.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">Blog works best with JavaScript enabled</div></noscript></body></html>