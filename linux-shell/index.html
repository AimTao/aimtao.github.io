<!DOCTYPE html><html lang="en" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" sizes="76x76" href="https://hutu0.aimtao.net/site/icon.webp"><link rel="icon" href="https://hutu0.aimtao.net/site/icon.webp"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="AimTao"><meta name="keywords" content="C++,Python,Go,算法，开发,blog,后端,记录"><meta name="description" content="本文在 linux 命令的基础上，具体描述 Shell 脚本的相关知识。"><title>学习笔记｜Shell - AimTao</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_2113603_2ltiep6fmf8.css"><link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.7.0/lxgwwenkai-regular.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"www.aimtao.net",root:"/",version:"1.9.1",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:"❡"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"sh"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h2,h3,h4",collapseDepth:2},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!0,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:"07fe5d228ae82eadee00480515f9d64b",google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"hkFccy0TBvlTMrTD2n9MwSIx-gzGzoHsz",app_key:"yUJSgy6kcnRscdGX9ec7jlFz",server_url:"https://analytics.aimtao.net",path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><style type="text/css">.spoiler{display:inline}p.spoiler{display:flex}.spoiler a{pointer-events:none}.spoiler-blur,.spoiler-blur>*{transition:text-shadow .5s ease}.spoiler .spoiler-blur,.spoiler .spoiler-blur>*{color:transparent;background-color:rgba(0,0,0,0);text-shadow:0 0 10px grey;cursor:pointer}.spoiler .spoiler-blur:hover,.spoiler .spoiler-blur:hover>*{text-shadow:0 0 5px grey}.spoiler-box,.spoiler-box>*{transition:color .5s ease,background-color .5s ease}.spoiler .spoiler-box,.spoiler .spoiler-box>*{color:#000;background-color:#000;text-shadow:none}</style><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="AimTao" type="application/atom+xml">
</head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>AimTao&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> Home</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> Categories</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> Tags</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> About</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> Links</a></li><li class="nav-item"><a class="nav-link" href="/atom.xml"><i class="iconfont icon-rss"></i> RSS</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="iconfont icon-archive-fill"></i> Archives</a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/archives/">Timeline </a><a class="dropdown-item" href="/categories/Implement-From-Scratch/">Implement From Scratch </a><a class="dropdown-item" href="/tags/Kernel/">Linux kernel </a><a class="dropdown-item" href="/categories/Mark/">Mark</a></div></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(https://hutu.aimtao.net/web/2021-05-07-linux-shell.webp-s) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="学习笔记｜Shell"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-05-07 23:36" pubdate>2021-05-07 PM</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 12k words </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 10 mins</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">学习笔记｜Shell</h1><p class="note note-info">本文最后更新于：4 years ago</p><div class="markdown-body"><blockquote><p>本文在 <a href="https://www.aimtao.net/linux/">linux 命令</a>的基础上，具体描述 Shell 脚本的相关知识。</p></blockquote><span id="more"></span><h2 id="1-shell格式">1.shell格式</h2><p>一堆命令写在在同一个文件里。</p><p><strong>注意</strong>：第一行 #! 与 shell 之间有空格。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#! /bin/sh</span><br><br><span class="hljs-comment"># this is my annotation</span><br><br><span class="hljs-built_in">echo</span> “Our frist an empty line <span class="hljs-keyword">in</span> output”<br><br>/bin/pwd<br></code></pre></td></tr></table></figure><h2 id="2-执行脚本">2.执行脚本</h2><p>source 是 bash shell 的内置命令。（与 . 等价）</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">bash my_shell<br>zsh my_shell<br>./my_shell<br><span class="hljs-built_in">source</span> my_shell<br><br>. ~/learn_shell/my_shell  <span class="hljs-comment"># .后面有空格，加绝对路径</span><br></code></pre></td></tr></table></figure><h2 id="3-内建命令">3.内建命令</h2><p>在使用 <code>export PATH=</code> 后，仍能执行的命令就是内建命令。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">man bash-builtins  <span class="hljs-comment"># 查看内建命令</span><br></code></pre></td></tr></table></figure><h2 id="4-小括号">4.小括号</h2><p>执行 cd 后，不改变工作目录。</p><p>相当于父进程为当前路径，子进程执行该命令。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">(<span class="hljs-built_in">cd</span> ..; <span class="hljs-built_in">ls</span> -al)<br>(<span class="hljs-built_in">cd</span> .. &amp;&amp; <span class="hljs-built_in">ls</span> -al)<br></code></pre></td></tr></table></figure><h2 id="5-变量">5.变量</h2><h3 id="5-1-数据类型">5.1 数据类型</h3><p>只有一种数据类型：字符串</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">a=1<br><span class="hljs-built_in">echo</span> a   <span class="hljs-comment"># 虽然结果得到的是 1，但是也是字符串类型</span><br></code></pre></td></tr></table></figure><h3 id="5-2-变量类型">5.2 变量类型</h3><blockquote><p>两种变量：环境变量、本地变量。</p></blockquote><ul><li>环境变量：环境变量存在于所有进程中。环境变量可以从父进程传给子进程，因此 Shell 进程的环境变量可以从当前 Shell 进程传递给 fork 出来的子进程。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-variable">$PATH</span>   <span class="hljs-comment"># 特殊的环境变量（命令程序所在目录）</span><br><span class="hljs-variable">$HOME</span>   <span class="hljs-comment"># 特殊环境变量（家目录）</span><br><span class="hljs-built_in">env</span>     <span class="hljs-comment"># 查看所有环境变量</span><br></code></pre></td></tr></table></figure><ul><li><p>本地变量：只存在于当前 Shell 进程中。</p><p>注意：等号两边不能有空格，否则会被解释成命令和命令参数。</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">set</span>   <span class="hljs-comment"># 查看所有本地变量</span><br>var_name = value   <span class="hljs-comment"># 定义本地变量</span><br></code></pre></td></tr></table></figure><h3 id="5-3-变量导出与删除">5.3 变量导出与删除</h3><ul><li>本地变量只能在当前 Shell 进程中使用，export 可以将本地变量导出为环境变量，使本地变量在其他进程中可以使用。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 定义、导出，两步完成</span><br>aaaa=2<br><span class="hljs-built_in">export</span> aaaa<br><br><span class="hljs-comment"># 一步完成</span><br><span class="hljs-built_in">export</span> aaaa=2<br></code></pre></td></tr></table></figure><ul><li>删除已定义的环境变量和本地变量。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">unset</span> aaaa<br></code></pre></td></tr></table></figure><h2 id="6-通配符">6.通配符</h2><blockquote><p>Wildcard</p></blockquote><table><thead><tr><th>通配符</th><th>含义</th></tr></thead><tbody><tr><td>*</td><td>匹配 0 个或者多个任意字符</td></tr><tr><td>?</td><td>匹配 1 个任意字符</td></tr><tr><td>[]</td><td>匹配方括号中任意一个字符</td></tr></tbody></table><ul><li><strong>通配符与正则表达式的区别</strong></li></ul><ol><li><p>用途不同</p><p>通配符用于通配文件名，正则表达式用于匹配文本内容</p></li><li><p>使用地点不同</p><p>通配符通常只能用于shell，被shell自解释。</p><p>正则表达式需要被正则引擎解析，需要用于支持正则表达式的代码或命令中。</p></li><li><p>元字符不同</p><p>通配符只有三个元字符，正则表达式根据正则引擎不同会多种多样。<br>并且相同元字符表示的含义也可能不同。如通配符中<em>表示匹配任意字符，正则中</em>表示前面的字符重复0或任意次。</p></li></ol><ul><li><strong>实例</strong>：使用 grep是字符串命令，需使用正则表达式；文件名通配使用通配符。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">ls</span> *.txt               <span class="hljs-comment"># 匹配全部后缀为.txt的文件</span><br><span class="hljs-built_in">ls</span> file?.<span class="hljs-built_in">log</span>           <span class="hljs-comment"># 匹配file1.log, file2.log, ...</span><br><span class="hljs-built_in">ls</span> [a-z]*.<span class="hljs-built_in">log</span>          <span class="hljs-comment"># 匹配a-z开头的.log文件</span><br><span class="hljs-built_in">ls</span> [^a-z]*.<span class="hljs-built_in">log</span>         <span class="hljs-comment"># 上面的反向匹配</span><br></code></pre></td></tr></table></figure><ul><li><strong>注意</strong></li></ul><p>反斜杠(<code>\</code>)或引号(<code>'</code>, <code>&quot;</code>)都会使通配符失效。</p><p>如: <code>\*</code>, <code>&quot;*&quot;</code>, <code>'*'</code>都表示<code>*</code>本身，不通配任何文件。</p><h2 id="7-命令代换">7.命令代换</h2><ul><li>由反引号括起来的是一条命令，Shell 应先执行该命令，再将执行结果代换到当前命令中。</li><li>等号两侧无空格。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">DATE=`<span class="hljs-built_in">date</span>`<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$DATE</span><br></code></pre></td></tr></table></figure><ul><li>命令代换可以使用 $() 表示。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">DATE=$(<span class="hljs-built_in">date</span>)<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$DATE</span><br></code></pre></td></tr></table></figure><h2 id="8-算术代换">8.算术代换</h2><p>算术代换要写两个括号或者一个中括号。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">var=10<br><span class="hljs-built_in">echo</span> $((<span class="hljs-variable">$var</span>+<span class="hljs-number">3</span>))<br><span class="hljs-built_in">echo</span> $((var+<span class="hljs-number">3</span>))<br><span class="hljs-built_in">echo</span> $[var+3]<br><span class="hljs-built_in">echo</span> $[<span class="hljs-variable">$var</span>+3]<br></code></pre></td></tr></table></figure><p>PS：二进制的100 + 十进制的3</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> $[2#100+1]   <span class="hljs-comment"># 输出 7</span><br></code></pre></td></tr></table></figure><h2 id="9-转义字符">9.转义字符</h2><ul><li>连接符：将第一行命令和第二行命令连接起来。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">ls</span> \<br>-l<br></code></pre></td></tr></table></figure><ul><li><p>转义符：将特殊字符转义</p><p>例如：创建 <code>$ $200.txt</code> 文件。其中 $ 和空格均需要转义。</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">touch</span> \$\ \<span class="hljs-variable">$200</span>.txt<br></code></pre></td></tr></table></figure><ul><li>PS：如何创建和删除 <code>---a.txt</code> 文件？<ul><li>方式一：写全路径！</li><li>方式二：使用 –</li></ul></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 方式一</span><br><span class="hljs-built_in">touch</span> ./---a.txt  <span class="hljs-comment"># 创建</span><br><span class="hljs-built_in">rm</span> -rf ./---a.txt  <span class="hljs-comment"># 删除</span><br><br><span class="hljs-built_in">touch</span> ---a.txt  <span class="hljs-comment"># 错误，---a会被识别成命令参数</span><br><br><span class="hljs-comment"># 方式二</span><br><span class="hljs-built_in">touch</span> -- ---a.txt<br><span class="hljs-built_in">rm</span> -rf -- ---a.txt<br></code></pre></td></tr></table></figure><h2 id="10-引号">10.引号</h2><p>引号是字符串的界定符。引号中的内容就是纯粹的字符串。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &#x27;$SHELL&#x27;<br></code></pre></td></tr></table></figure><ul><li><p>例：想要输出 <code>hello 'hello'</code></p><p>输出单引号使用双引号作为界定符，输出双引号使用单引号作为界定符。</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;hello &#x27;hello&#x27;&quot;</span><br></code></pre></td></tr></table></figure><ul><li><p><strong>单引号和双引号区别</strong></p><p>双引号防止通配符扩展，但是允许变量扩展。</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$SHELL</span>&quot;</span>   <span class="hljs-comment"># 环境变量路径</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;$SHELL&#x27;</span>   <span class="hljs-comment"># 单纯的字符串</span><br></code></pre></td></tr></table></figure><p><strong>PS：作为好的 Shell 编程习惯，应该总是把变量取值放在双引号内。</strong></p><h2 id="11-shell脚本语法">11.shell脚本语法</h2><h3 id="11-1-条件测试-test">11.1 条件测试 test</h3><ul><li><strong><code>$?</code> ：上一个进程退出返回的值。</strong></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> $?<br></code></pre></td></tr></table></figure><ul><li><strong>例1：使用 test 比较大小</strong></li></ul><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-eq</td><td>等于</td></tr><tr><td>-ne</td><td>不等于</td></tr><tr><td>-lt</td><td>小于</td></tr><tr><td>-le</td><td>小于等于</td></tr><tr><td>-gt</td><td>大于</td></tr><tr><td>-ge</td><td>大于等于</td></tr></tbody></table><p>PS：返回 0 表示真，返回 1 表示假。【和其他语言相反】</p><p>注意：比较双方只能是整数或者整数变量。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 定义变量</span><br>var=20<br><br><span class="hljs-comment"># 比较 var 是否大于 100</span><br><span class="hljs-built_in">test</span> <span class="hljs-variable">$var</span> -gt 100<br><br><span class="hljs-comment"># 打印上个进程的结果</span><br>eoch $?   <span class="hljs-comment"># 返回 0，表示假，表示 var 不大于 100</span><br></code></pre></td></tr></table></figure><ul><li><strong>例2：使用 test 判断类型</strong></li></ul><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-d</td><td>是否是目录</td></tr><tr><td>-f</td><td>是否是普通文件</td></tr><tr><td>-z</td><td>stging 是否为零</td></tr><tr><td>-n</td><td>stging 是否为非零</td></tr><tr><td>=</td><td>两个字符串是否相同</td></tr><tr><td>!=</td><td>两个字符串是否不相同</td></tr></tbody></table><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 1.判断文件夹</span><br><span class="hljs-built_in">test</span> -d my_dir<br><br><span class="hljs-comment"># 2.判断普通文件</span><br><span class="hljs-built_in">test</span> -f my_fifo<br><br><span class="hljs-comment"># 3.判断字符串长度是否为0</span><br>var=aa<br><span class="hljs-built_in">test</span> -z var<br><br><span class="hljs-comment"># 4.判断字符串是否相等</span><br>var1=a<br>var2=b<br><span class="hljs-built_in">test</span> <span class="hljs-variable">$var1</span> = <span class="hljs-variable">$var2</span>  <span class="hljs-comment"># 等号两端必须有空格 </span><br><span class="hljs-built_in">test</span> 2 = 2<br></code></pre></td></tr></table></figure><ul><li><strong>例3：使用 <code>[]</code> 代替 test</strong></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">var1=a<br>var2=b<br>[ <span class="hljs-variable">$var1</span> = <span class="hljs-variable">$var2</span> ]   <span class="hljs-comment"># 中括号和等号两端需要有空格</span><br><br>[ -f my_fifo ]<br></code></pre></td></tr></table></figure><ul><li><strong>例4：链接符 -a、-o</strong></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">[ -f my_fifo -a -d my_dir ]  <span class="hljs-comment"># and</span><br><br>[ -f my_fifo -o -d my_dir ]  <span class="hljs-comment"># or</span><br></code></pre></td></tr></table></figure><h3 id="11-2-模糊匹配-if">11.2 模糊匹配 if</h3><ul><li><strong>if、then、elif、else、fi 的使用</strong></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-keyword">if</span> [ -f frist_shell ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;This is common file&quot;</span><br><span class="hljs-keyword">elif</span> [ -d frist_shell ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;This is dir&quot;</span><br><span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;unkonw\n&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p>PS：<code>then</code> 可以分行写，这样 <code>;</code> 不用写，如下所示。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-keyword">if</span> [ -f frist_shell ]<br><span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;This is common file&quot;</span><br><span class="hljs-keyword">elif</span> [ -d frist_shell ]<br><span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;This is dir&quot;</span><br><span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;unkonw\n&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><ul><li><strong>写成一行</strong></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-keyword">if</span> [ -f frist_shell ]; <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;This is common file&quot;</span>; <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;unkonw\n&quot;</span>; <span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><ul><li><code>:</code> 是一个特殊的命令</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-keyword">if</span> :; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;always true&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><h3 id="11-3-精准匹配-case">11.3 精准匹配 case</h3><ul><li><p><code>;;</code> 表示语句结束，类似于 C 语言中的 <code>break</code>。【一定别忘了】</p></li><li><p><strong>例：根据输入做 case 判断</strong></p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#! /bin/zsh</span><br><br><span class="hljs-comment"># 输入数据保存到 BUF 中</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Enter a yes or no&quot;</span><br><span class="hljs-built_in">read</span> BUF<br><br><span class="hljs-comment"># 进行 case 判断</span><br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;<span class="hljs-variable">$BUF</span>&quot;</span> <span class="hljs-keyword">in</span><br>    <span class="hljs-built_in">yes</span>|Yes|YES|y|Y)    <span class="hljs-comment"># 第一种情况</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;It is a yes&quot;</span>;;<br>    [nN]?)              <span class="hljs-comment"># 第二种情况</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;It is a no&quot;</span>;;<br>    *)                  <span class="hljs-comment"># 其他情况</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;other case&quot;</span>;;<br><span class="hljs-keyword">esac</span>       <span class="hljs-comment"># 结束</span><br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Going to return&quot;</span><br><span class="hljs-built_in">return</span> 0<br></code></pre></td></tr></table></figure><ul><li><strong>实际应用</strong></li></ul><p>服务 start、stop、status 等均是通过参数来控制，可以用 case 做脚本进行控制。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;<span class="hljs-variable">$parameter</span>&quot;</span> <span class="hljs-keyword">in</span> <br>    start)<br>        ...;;<br>    stop)<br>        ...;;<br>    restart)<br>        ...;;<br>    status)<br>        ...;;<br>    *)<br>        ...;;<br><span class="hljs-keyword">esac</span><br></code></pre></td></tr></table></figure><h3 id="11-4-循环-for">11.4 循环 for</h3><blockquote><p>类似于 foreach，枚举。</p></blockquote><ul><li>例1：在三种水果中进行枚举。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-keyword">for</span> FRUIT <span class="hljs-keyword">in</span> apple banana pear; <span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;I like <span class="hljs-variable">$FRUIT</span>&quot;</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><ul><li><p>例2：批量改名</p><p>找到所有的 chap1、chap2，更改为 chap1~、chap2~。</p></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-keyword">for</span> FILE_NAME <span class="hljs-keyword">in</span> chap?; <span class="hljs-keyword">do</span> <span class="hljs-built_in">mv</span> <span class="hljs-string">&quot;<span class="hljs-variable">$FILE_NAME</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$FILE_NAME</span>~&quot;</span>; <span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h3 id="11-5-循环-while">11.5 循环 while</h3><p>count 自减，循环输出 count 值。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">count=3<br><span class="hljs-keyword">while</span> [ <span class="hljs-variable">$count</span> -gt 0 ]; <span class="hljs-keyword">do</span><br>    count=$[count-1]   <span class="hljs-comment"># 赋值过程中，左侧不写$    # 算术代换使用 []</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;count = <span class="hljs-variable">$count</span>&quot;</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h3 id="11-6-break-与-continue">11.6 break 与 continue</h3><p>break：可以指定跳出几层循环。</p><p>continue：跳过本次循环，但不会跳出循环。</p><h2 id="12-特殊变量与输入输出">12.特殊变量与输入输出</h2><p>特殊变量是由 Shell 自动赋值的。</p><table><thead><tr><th>自动变量</th><th>含义</th></tr></thead><tbody><tr><td>$0</td><td>相当于 c 中的 argv[0]</td></tr><tr><td>$1、$2…</td><td>相当于 c 中的 argv[1]、argv[2]…</td></tr><tr><td>$#</td><td>参数个数，argc - 1</td></tr><tr><td>$@</td><td>表示参数列表 $1、$2、$3、$4…<br>例如可以使用在 for in 后面</td></tr><tr><td>$*</td><td>同上</td></tr><tr><td>$?</td><td>上一条命令的 Exit Status</td></tr><tr><td>$$</td><td>当前进程号</td></tr></tbody></table><p>shift 是参数左移出队的操作。</p><ul><li>shift 相当于 shift1</li><li>shift3：左移出队三个参数</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">./my.sh aa bb cc <span class="hljs-built_in">dd</span> ee<br><br><span class="hljs-comment"># my.sh 中有 shift2 后，my.sh 的数就变为 cc、dd、ee</span><br></code></pre></td></tr></table></figure><p><strong>例子</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;第一个参数%s 是 %s\n&quot;</span> <span class="hljs-string">&#x27;$0&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$0</span>&quot;</span><br><span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;参数个数%s 是 %s\n&quot;</span> <span class="hljs-string">&#x27;$#&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$#</span>&quot;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;循环打印参数列表&quot;</span><br><br><span class="hljs-keyword">for</span> arg <span class="hljs-keyword">in</span> <span class="hljs-variable">$@</span>; <span class="hljs-keyword">do</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$arg</span>&quot;</span>     <br><span class="hljs-keyword">done</span><br><br><span class="hljs-comment"># 作为好的 Shell 编程习惯，应该总是把变量取值放在双引号内。(引号内是纯粹的字符串</span><br>，但双引号允许变量扩展)<br><br><span class="hljs-comment"># 使用变量前面应加上 $</span><br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;使用 shift 进行参数左移&quot;</span><br><br><span class="hljs-built_in">shift</span>  <span class="hljs-comment"># 左移一次</span><br><span class="hljs-keyword">for</span> arg <span class="hljs-keyword">in</span> <span class="hljs-variable">$@</span>; <span class="hljs-keyword">do</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$arg</span>&quot;</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><ul><li>echo 有两个参数：-e 和 -n</li></ul><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>echo</td><td>默认有一个回车</td></tr><tr><td>-e</td><td>解析转义字符</td></tr><tr><td>-n</td><td>不换行</td></tr></tbody></table><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;hello\n&quot;</span>      <span class="hljs-comment"># 无回车</span><br><span class="hljs-built_in">echo</span> -e “hello\n”   <span class="hljs-comment"># 有回车</span><br></code></pre></td></tr></table></figure><h2 id="13-管道">13.管道</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">ls</span> | grep more<br></code></pre></td></tr></table></figure><h2 id="14-tee">14.tee</h2><p>将标准输出同时输出到指定的文件中。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">ls</span> | <span class="hljs-built_in">tee</span> out.txt<br></code></pre></td></tr></table></figure><h2 id="15-文件重定向">15.文件重定向</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># cmd &gt; file</span><br><span class="hljs-comment"># 例：将 ls 输出结果重定向给 file。</span><br><span class="hljs-built_in">ls</span> &gt; file<br><br><span class="hljs-comment"># cmd &gt;&gt; file</span><br><span class="hljs-comment"># 例：将 ls 输出结果追加在 file 文件末尾。</span><br><span class="hljs-built_in">ls</span> &gt;&gt; file<br><br><span class="hljs-comment"># cmd &gt; file 2&gt;&amp;1</span><br><span class="hljs-comment"># 例：将 ls abc.txt 的结果重定向到 file 中（如果命令没有执行成功，产生报错信息，将把报错信息写入 file 中）。</span><br><span class="hljs-comment"># 注意：2&gt;&amp;1 符号两侧没有空格，表示：文件描述符2（标准错误）重定向到文件描述符1（标准输出）。</span><br><span class="hljs-built_in">ls</span> abc.txt &gt; file 2&gt;&amp;1<br><br><span class="hljs-comment"># cmd &lt; file &gt; new_file</span><br><span class="hljs-comment"># 例：[拷贝] 从 file 中读取内容，并写入 new_file。</span><br><span class="hljs-built_in">cat</span> &lt; file &gt; new_file<br><br><span class="hljs-comment"># 例：[统计] 将 file 的行数进行统计，并将统计结果写入 new_file 中。</span><br><span class="hljs-built_in">wc</span> -l &lt; file &gt; new_file<br><br><span class="hljs-comment"># 技巧：重定向至黑洞中。</span><br><span class="hljs-built_in">ls</span> &gt; /dev/null 2&gt;&amp;1<br></code></pre></td></tr></table></figure><h2 id="16-函数">16.函数</h2><blockquote><p>有函数定义，但是没有函数返回值、函数列表。</p><p>先定义、再使用。</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">foo()     <span class="hljs-comment"># 定义函数</span><br>&#123;<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;This is function!&quot;</span><br>&#125;<br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;----start----&quot;</span><br>foo       <span class="hljs-comment"># 使用函数</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;----end----&quot;</span><br></code></pre></td></tr></table></figure><ul><li><strong>如何使用参数？</strong></li></ul><p>使用 $1、$2、$3…来表示函数的参数。</p><p>注意：函数内部使用 $1、$2、$3…只能使用函数的参数。（同时 $#、$@ 也是表示函数的参数列表，而不是整个脚本的参数）</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-function"><span class="hljs-title">foo</span></span>()<br>&#123;<br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$0</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$1</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$2</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$3</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;This is function!&quot;</span><br>&#125;<br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;----start----&quot;</span><br>foo 11 22 33<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;----end----&quot;</span><br><br><span class="hljs-comment"># 打印结果：</span><br>----start----<br>foo<br>11<br>22<br>33<br>This is <span class="hljs-keyword">function</span>!<br>----end----<br></code></pre></td></tr></table></figure><p><strong>实例</strong>：批量创建文件夹。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-function"><span class="hljs-title">is_dir</span></span>()<br>&#123;<br>  dir_name=<span class="hljs-variable">$1</span><br>  <span class="hljs-keyword">if</span> [ ! -d <span class="hljs-variable">$dir_name</span> ]; <span class="hljs-keyword">then</span>    <span class="hljs-comment"># 不是目录 ==》 真 ==》 test 返回 0 ==》 if 假 ==》 return 0；</span><br>    <span class="hljs-built_in">return</span> 1;<br>  esle<br>    <span class="hljs-built_in">return</span> 0;<br>  <span class="hljs-keyword">fi</span><br>&#125;<br><br><span class="hljs-keyword">for</span> dir_name <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span>; <span class="hljs-keyword">do</span><br>  <span class="hljs-keyword">if</span> is_dir <span class="hljs-variable">$dir_name</span>; <span class="hljs-keyword">then</span><br>      <span class="hljs-built_in">echo</span> “<span class="hljs-variable">$dir_name</span> is exits.”<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$dir_name</span> is not exits,creating it now.&quot;</span><br>    <span class="hljs-built_in">mkdir</span> <span class="hljs-variable">$dir_name</span> &gt; /dev/null 2&gt;&amp;1<br>    <span class="hljs-keyword">if</span> [ $? -ne 0 ]; <span class="hljs-keyword">then</span><br>      <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;error: Cannot create <span class="hljs-variable">$dir_name</span>.&quot;</span><br>      <span class="hljs-built_in">exit</span> 1;<br>    <span class="hljs-keyword">fi</span><br>  <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h2 id="17-调试-shell-脚本">17.调试 shell 脚本</h2><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-n</td><td></td></tr><tr><td>-v</td><td></td></tr><tr><td>-x</td><td></td></tr></tbody></table><h2 id="18-正则表达式">18.正则表达式</h2><blockquote><p>查找文件中的内容，字符串匹配（grep，egrep）见<a href="#基础正则和扩展正则">基础正则和扩展正则区别</a>&gt;。</p><p>注意：Linux 中使用，一定要使用双引号。</p></blockquote><p><strong>（1）字符类</strong></p><table><thead><tr><th>字符</th><th>含义</th><th>举例</th><th>说明</th></tr></thead><tbody><tr><td>.</td><td>匹配任意一个字符</td><td>abc.</td><td>匹配 abcd、abc9等</td></tr><tr><td>[]</td><td>匹配括号中任一字符</td><td>[abc]</td><td>只能匹配a、b、c</td></tr><tr><td>-</td><td>在[]括号内表示字符范围</td><td>[0-9a-fA-F]</td><td>匹配一位十六进制的数字</td></tr><tr><td>^</td><td>位于[]括号内的开头，匹配除括号中的字符之外的任意一个字符</td><td>[^xy]</td><td>匹配除 xy 之外的任一字符，可以匹配 a1、b1，但不能匹配 x1、y1</td></tr><tr><td>[[:xxx:]]</td><td>grep 工具预定义的一些命名字符类</td><td>[[:alpha:]] /[[:digit:]]</td><td>匹配一个字母 / 匹配一个数字</td></tr></tbody></table><ul><li><code>.</code> 匹配任意一个字符。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum list installed | grep .um  <span class="hljs-comment"># um 前面必须有一个字符。</span><br></code></pre></td></tr></table></figure><ul><li><code>[mn]</code> 匹配 [] 里的任意一个字符。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">➜  ~ yum list installed | grep <span class="hljs-string">&quot;[mn]aria&quot;</span>   <span class="hljs-comment"># 注意双引号</span><br>mariadb.x86_64                        1:5.5.65-1.el7                   @base    <br>mariadb-libs.x86_64                   1:5.5.65-1.el7                   @anaconda<br>mariadb-server.x86_64                 1:5.5.65-1.el7                   @base <br></code></pre></td></tr></table></figure><ul><li><code>[^yd]</code> 匹配除 [] 中字符的其他任一字符。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum list installed | grep <span class="hljs-string">&quot;[^yd]um&quot;</span>     <span class="hljs-comment"># 注意双引号</span><br>numactl-libs.x86_64                   2.0.12-5.el7                     @anaconda<br>perl-Data-Dumper.x86_64               2.145-3.el7                      @base   <br></code></pre></td></tr></table></figure><ul><li><code>\w</code> 【小写w】匹配文字和数字字符，也就是 [A-Za-z0-9]。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;\w&quot;</span> 1.txt  <span class="hljs-comment"># 必须有双引号</span><br></code></pre></td></tr></table></figure><ul><li><code>\W</code> 【大写W】匹配非文字和数字字符，“\w” 的反置形式。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;\W&quot;</span> 1.txt  <span class="hljs-comment"># 必须有双引号</span><br></code></pre></td></tr></table></figure><p><strong>（2）数量限定符</strong></p><table><thead><tr><th>字符</th><th>含义</th><th>举例</th><th>说明</th></tr></thead><tbody><tr><td>？</td><td>紧跟在它前面的单元应匹配零次或一次</td><td>[0-9]?\.[0-9]</td><td>可匹配 0.0、2.3、.5</td></tr><tr><td>+</td><td>紧跟在它前面的单元应匹配一次或多次</td><td>[0-9a-zA-Z_.-]+@[0-9a-zA-Z_.-]+\.com</td><td>匹配邮箱</td></tr><tr><td>*</td><td>紧跟在它前面的单元应匹配零次或多次</td><td></td><td></td></tr><tr><td>{N}</td><td>紧跟在它前面的单元应匹配 N 次</td><td>[1-9][0-9]{2}</td><td>匹配100-999的整数</td></tr><tr><td>{N,}</td><td>紧跟在它前面的单元应匹配至少 N 次</td><td>[1-9][0-9]{2,}</td><td>匹配大于等于100的数</td></tr><tr><td>{,M}</td><td>紧跟在它前面的单元应匹配最多 M 次</td><td></td><td></td></tr><tr><td>{N,M}</td><td>紧跟在它前面的单元应匹配至少 N 次，最多 M 次</td><td>[0-9]{1,3}(.[0-9]{1,3}){3}</td><td>匹配 ip，()内重复三次</td></tr></tbody></table><ul><li><code>*</code> *前面的字符可以重复 0 次或者 多次。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;a*b&quot;</span>   <span class="hljs-comment"># 表示 a 可以出现多次或者0次</span><br></code></pre></td></tr></table></figure><ul><li><code>x\&#123;m\&#125;</code> 匹配 <em>字符 x重复 m 次</em> 的行。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">➜  ~ yum list installed | grep <span class="hljs-string">&quot;0\&#123;3\&#125;&quot;</span>   <span class="hljs-comment"># 查找重复 3 次 0 的行。</span><br>iwl1000-firmware.noarch  <br>iwl2000-firmware.noarch   <br>iwl5000-firmware.noarch    <br>iwl6000-firmware.noarch  <br>iwl6000g2a-firmware.noarch   <br>iwl6000g2b-firmware.noarch    <br></code></pre></td></tr></table></figure><ul><li><code>x\&#123;m,\&#125;</code> 匹配 <em>字符 x 重复 m 次或者 m 次<strong>以上</strong></em> 的行。[m, +∞)</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;0\&#123;2,\&#125;&quot;</span> 1.txt   <span class="hljs-comment"># 查找 0 重复 2 次以上的行。</span><br></code></pre></td></tr></table></figure><ul><li><code>x\&#123;m, n\&#125;</code> 匹配 <em>字符 x 重复 m 次或者 m 次以上，不超过 n 次</em> 的行。 [m, n]</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;0\&#123;2,3\&#125;&quot;</span> 1.txt  <span class="hljs-comment"># 查找 重复次数在 [2, 3] 之间的行。</span><br></code></pre></td></tr></table></figure><p><strong>（3）位置限定符</strong></p><table><thead><tr><th>字符</th><th>含义</th><th>举例</th><th>说明</th></tr></thead><tbody><tr><td>^</td><td>匹配行首的位置</td><td>^Content</td><td>匹配位于一行开头的 <code>Content</code></td></tr><tr><td>$</td><td>匹配行末的位置</td><td>answer:$</td><td>匹配位于一行结尾的 <code>answer:</code></td></tr><tr><td>\&lt;</td><td>匹配单词开头的位置</td><td>\&lt;ab</td><td>匹配 ab 开头的单词</td></tr><tr><td>\&gt;</td><td>匹配单词结尾的位置</td><td>ab\&gt;</td><td>匹配 ab 结尾的单词</td></tr><tr><td>\b</td><td>匹配单词开头或结尾的位置</td><td></td><td>可以完全取代 \&lt; 和 \&gt;</td></tr><tr><td>\B</td><td>匹配非单词开头和结尾的位置</td><td>\Bab\B</td><td>ab 既不在开头，也不在结尾</td></tr></tbody></table><ul><li>匹配行开头。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum list installed | grep ^a<br>grep ^a 1.txt<br></code></pre></td></tr></table></figure><ul><li>匹配行结尾。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum list installed | grep a$<br></code></pre></td></tr></table></figure><ul><li>匹配单词开头。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum list installed | grep <span class="hljs-string">&quot;\&lt;maria&quot;</span>  <span class="hljs-comment"># 匹配以 db 开头的单词所在的行，例如mariadb，注意要有双引号</span><br></code></pre></td></tr></table></figure><ul><li>匹配单词结尾。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum list installed | grep <span class="hljs-string">&quot;db\&gt;&quot;</span>     <span class="hljs-comment"># 匹配以 db 结尾的单词所在的行，例如mariadb，注意要有双引号</span><br></code></pre></td></tr></table></figure><ul><li>匹配单词。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum list installed | grep <span class="hljs-string">&quot;mariadb&quot;</span>  <span class="hljs-comment"># 只能匹配完整的单词 mariadb，例如：可以匹配 mari</span><br></code></pre></td></tr></table></figure><p><strong>（4）其他特殊字符</strong></p><table><thead><tr><th>字符</th><th>含义</th><th>举例</th></tr></thead><tbody><tr><td>\</td><td>转义字符，将特殊字符转义为普通字符；普通字符转义为特殊字符。</td><td>文本中出现 <code>.</code> 需要使用 <code>\.</code> 来进行转义。<br>普通字符 &lt;&gt; 转义为匹配开头和结尾 <code>\&lt;</code> <code>\&gt;</code> 。</td></tr><tr><td>()</td><td>将正则表达式一部分括起来组成一个单元，可以对整个单元使用数量限定符。</td><td>[0-9]{1,3}(.[0-9]{1,3}){3}</td></tr><tr><td>|</td><td>连接两个子表达式，表示或的关系。</td><td>n(o|either)，匹配 no、neither</td></tr></tbody></table><p><strong><a name="基础正则和扩展正则">（5）基础正则和扩展正则</a></strong><br>egrep 可以直接使用扩展正则。grep 若要使用扩展正，则有两种方式：</p><ul><li>将 ?+{}|() 使用 \ 进行转义。</li><li>加 -E 参数，grep -E</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">egrep <span class="hljs-string">&quot;[0-9]&#123;1,3&#125;(\.[0-9]&#123;1,3&#125;)&#123;3&#125;&quot;</span> text<br>grep <span class="hljs-string">&quot;[0-9]\&#123;1,3\&#125;\(\.[0-9]\&#123;1,3\&#125;\)\&#123;3\&#125;&quot;</span> text<br>grep -E <span class="hljs-string">&quot;[0-9]&#123;1,3&#125;(\.[0-9]&#123;1,3&#125;)&#123;3&#125;&quot;</span> text<br></code></pre></td></tr></table></figure><h2 id="19-sed">19.sed</h2><blockquote><p>筛选行数据。</p></blockquote><h3 id="19-1-命令格式">19.1 命令格式</h3><ol><li><strong>sed 参数 ’脚本语句‘ 待操作文件</strong></li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">sed <span class="hljs-string">&#x27;/echo/s/echo/printf/g&#x27;</span> my_shell.sh<br>sed <span class="hljs-string">&#x27;s/echo/printf/g&#x27;</span> my_shell.sh<br></code></pre></td></tr></table></figure><ul><li>echo：在 my_shell.sh 中找到 echo</li><li>s：表示字符串替换</li><li>echo/printf：将 echo 替换成 printf</li><li>g：一行出现多次 echo，均全部替换</li></ul><ol start="2"><li><strong>sed 参数 -f ’脚本文件‘ 待操作的文件</strong></li></ol><h3 id="19-2-命令参数">19.2 命令参数</h3><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-n</td><td>静默输出，sed 程序在所有脚本指令执行完毕后，自动打印模式空间中的内容。-n屏蔽自动打印。</td></tr><tr><td>-f</td><td>从文件中读取脚本指令</td></tr><tr><td>-i</td><td>直接修改源文件。经过脚本指令处理的内容直接输出至源文件。</td></tr><tr><td>-r</td><td>使用扩展正则。</td></tr></tbody></table><h3 id="19-3-脚本格式">19.3 脚本格式</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">/pattern/action<br></code></pre></td></tr></table></figure><ul><li><p>pattern 是正则表达式，action 是编辑操作。</p></li><li><p>sed 一行行读取待处理文件，如果某一行与 pattern 匹配，则执行相应的 action</p></li><li><p>如果一条命令没有 pattern，而只有 action，这个 action 将作用于待处理文件的每一行。</p></li></ul><p><strong>举例</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">/pattern/p    <span class="hljs-comment"># 打印匹配 pattern 的行</span><br>/pattern/d <span class="hljs-comment"># 删除匹配 pattern 的行</span><br><br>/pattern/s/pattern1/pattern2/  <span class="hljs-comment"># 查找符合 pattern 的行，将该行第一个匹配 pattern1 的字符串替换成 pattern2</span><br>/pattern/s/pattern1/pattern2/g  <span class="hljs-comment"># 查找符合 pattern 的行，将该行所有匹配 pattern 字符串替换成 pattern2</span><br></code></pre></td></tr></table></figure><h3 id="19-4-脚本参数">19.4 脚本参数</h3><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>a</td><td>append 追加</td></tr><tr><td>i</td><td>insert 插入</td></tr><tr><td>d</td><td>delete 删除</td></tr><tr><td>s</td><td>substitution 替换</td></tr></tbody></table><ul><li><strong>append</strong></li></ul><p>在 my_shell.sh 的第 4 行后，追加一行，append_line 在第 5 行显示。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sed <span class="hljs-string">&#x27;4a append_line&#x27;</span> my_shell.sh<br></code></pre></td></tr></table></figure><ul><li><strong>insert</strong></li></ul><p>在 my_shell.sh 的第4行，插入一行，insert_line 在第 4 行显示。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sed <span class="hljs-string">&#x27;4i insert_line&#x27;</span> my_shell.sh<br></code></pre></td></tr></table></figure><ul><li><strong>delete</strong></li></ul><blockquote><p>注意：替换修改源文件需要加参数 -i。</p></blockquote><p>删除 my_shell.sh 的第 4 行。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sed <span class="hljs-string">&#x27;4d&#x27;</span> my_shell.sh<br></code></pre></td></tr></table></figure><p>删除 my_shell.sh 的第 2 到第 7 行。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sed <span class="hljs-string">&#x27;2,7d&#x27;</span> my_shell.sh<br></code></pre></td></tr></table></figure><ul><li><strong>substitution</strong></li></ul><blockquote><p>注意：替换修改源文件需要加参数 -i。</p></blockquote><p>将 my_shell.sh 的 echo 替换成 printf。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">sed <span class="hljs-string">&#x27;s/echo/printf/g&#x27;</span> my_shell.sh<br><br><span class="hljs-comment"># s：表示字符串替换</span><br><span class="hljs-comment"># echo/printf：将 echo 替换成 printf</span><br><span class="hljs-comment"># g：一行出现多次 echo，均全部替换</span><br></code></pre></td></tr></table></figure><h3 id="19-5-替代符">19.5 替代符</h3><ul><li><strong>&amp;</strong></li></ul><p>在 abc 的两侧加入 <code>==</code> 。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sed <span class="hljs-string">&#x27;s/abc/==&amp;==/&#x27;</span> my_shell.sh<br></code></pre></td></tr></table></figure><ul><li><strong>\1</strong></li></ul><blockquote><p>sed 只支持 basic 正则表达式规范。</p></blockquote><p>匹配两个数字，第一个数字部分用 \1 表示，第二个数字数字用 \2 表示，在 \1 和 \2 位置两侧分别加入 == 和 @@。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># sed &#x27;s/([0-9])([0-9])/==\1==@@\2@@/g&#x27; my_shell.sh</span><br><span class="hljs-comment"># 上面脚本并不能成功执行，需要加 ()，加 () 才能表示一个部分，并转义。</span><br><span class="hljs-comment"># 或者使用 -r 进行转义。</span><br><br>sed <span class="hljs-string">&#x27;s/\([0-9]\)\([0-9]\)/==\1==@@\2@@/g&#x27;</span> my_shell.sh<br>sed -r <span class="hljs-string">&#x27;s/([0-9])([0-9])/==\1==@@\2@@/g&#x27;</span> my_shell.sh<br></code></pre></td></tr></table></figure><h3 id="19-6-其他">19.6 其他</h3><ul><li>同一个文件，两个替换命令。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sed <span class="hljs-string">&#x27;s/a/A/;s/b/B/&#x27;</span> my_shell.sh<br></code></pre></td></tr></table></figure><ul><li>同一个文件，两个替换命令。（使用 -e 指定）</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sed -e <span class="hljs-string">&#x27;s/a/A&#x27;</span> -e <span class="hljs-string">&#x27;s/b/B&#x27;</span> my_shell.sh<br></code></pre></td></tr></table></figure><ul><li><strong>案例</strong>：将 html 的标签删除。</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh">&lt;script data-compress=strip&gt;<br>    <span class="hljs-keyword">function</span> h(obj)&#123;<br>        obj.style.behavior=<span class="hljs-string">&#x27;url(#default#homepage)&#x27;</span>;<br>        var a = obj.setHomePage(<span class="hljs-string">&#x27;//www.baidu.com/&#x27;</span>);<br>    &#125;<br>&lt;/script&gt;<br>&lt;script&gt;<br>    _manCard = &#123;<br>        asynJs : [],<br>        asynLoad : <span class="hljs-keyword">function</span>(<span class="hljs-built_in">id</span>)&#123;<br>            _manCard.asynJs.push(<span class="hljs-built_in">id</span>);<br>        &#125;<br>    &#125;;<br>    window._sp_async = 1;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>思路：</p><ol><li><code>[^&lt;&gt;]</code>：匹配任意一个非 &lt;&gt; 的字符。</li><li><code>[^&lt;&gt;]*</code>：确保匹配到 &lt;&gt; 中的一串字符。</li><li><code>&lt;[^&lt;&gt;]*&gt;</code>：强制要求所匹配到的字符串两端需要有 &lt;&gt;。</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sed <span class="hljs-string">&#x27;s/&lt;[^&lt;&gt;]*&gt;/g&#x27;</span> html<br></code></pre></td></tr></table></figure><h2 id="20-awk">20.awk</h2><blockquote><p>sed：处理行数据</p><p>awk：处理列数据</p></blockquote><h3 id="20-1-命令格式">20.1 命令格式</h3><ol><li><strong>awk 参数 ‘脚本语句’ 待操作文件</strong></li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 打印文件的第一列</span><br>awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> file<br></code></pre></td></tr></table></figure><ol start="2"><li><strong>awk 参数 -f ‘脚本语句’ 待操作文件</strong></li></ol><h3 id="20-2-命令参数">20.2 命令参数</h3><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-F:</td><td>指定列的分隔符为 <code>:</code>。冒号可以换成其他符号。</td></tr></tbody></table><ul><li>-F</li></ul><p>在 /etc/passwd 中，以 <code>:</code> 分割每一列。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">awk -F: <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> /etc/passwd<br></code></pre></td></tr></table></figure><h3 id="20-3-脚本格式">20.3 脚本格式</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">/pattern/&#123;action&#125;<br>condition&#123;action&#125;<br></code></pre></td></tr></table></figure><p><strong>例</strong>：有以下三行数据，筛选大于等于 50 的行。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">product</span> <span class="hljs-number">30</span><br><span class="hljs-attribute">product</span> <span class="hljs-number">76</span><br><span class="hljs-attribute">product</span> <span class="hljs-number">55</span><br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">awk <span class="hljs-string">&#x27;$2&lt;50 &#123;print $0&#125; $2&gt;=50 &#123;print $0 &quot; reorder&quot;&#125;&#x27;</span> file<br>awk <span class="hljs-string">&#x27;$2&lt;50 &#123;print $0&#125; $2&gt;=50 &#123;print(&quot;%s reorder&quot;, $0)&#125;&#x27;</span> file<br></code></pre></td></tr></table></figure><h3 id="20-4-使用变量">20.4 使用变量</h3><p><strong>例</strong>：统计文本的空行数。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">awk <span class="hljs-string">&#x27;/^ *$/ &#123;count=count+1&#125; END &#123;print count&#125;&#x27;</span> file<br></code></pre></td></tr></table></figure><ul><li><code>/^ *$/</code>：匹配空格开头，空格重复零次或多次，并以此结尾。</li><li><code>&#123;count=count+1&#125;</code>：使用 count 进行计数。</li><li><code>END</code>：匹配结束进行打印。</li></ul><p><strong>例</strong>：统计 id 在 [2600, 2700) 的行数。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">ps aux | awk <span class="hljs-string">&#x27;$2&gt;=2600 &amp;&amp; $2&lt;2700 &#123;count=count+1&#125; END &#123;print count&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>补充</strong>：</p><ul><li>END 是在匹配最后进行操作。</li><li>BEGIN 是在匹配之前进行操作。</li></ul><p>在匹配之前，对文本进行拆分。（以<code>:</code> 为分割进行拆分）</p><blockquote><p>FS 是内建变量，实际上是宏。表示分隔符，缺省是来纳许的空格和 tab。</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">awk <span class="hljs-string">&#x27;BEGIN &#123;FS=&quot;:&quot;&#125; &#123;print $1&#125;&#x27;</span> /etc/passwd<br></code></pre></td></tr></table></figure><h2 id="21-C语言使用正则">21.C语言使用正则</h2><ol><li>编译正则表达式 regcomp()</li><li>匹配正则表达式 regexec()</li><li>释放正则表达式 regfree()</li></ol><script type="text/javascript">!function(l){[].forEach.call(l.getElementsByClassName("fold"),(function(l){l.getElementsByClassName("fold-title")[0].onclick=function(){l.classList.toggle("collapsed"),l.classList.toggle("expanded")}}))}(document)</script></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/Mark/" class="category-chain-item">Mark</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Linux/">#Linux</a> <a href="/tags/Shell/">#Shell</a></div></div><div class="license-box my-3"><div class="license-title"><div>学习笔记｜Shell</div><div>https://www.aimtao.net/linux-shell/</div></div><div class="license-meta"><div class="license-meta-item license-meta-date"><div>Posted on</div><div>2021-05-07</div></div><div class="license-meta-item"><div>Licensed under</div><div><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - Attribution"><i class="iconfont icon-by"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - Non-commercial"><i class="iconfont icon-nc"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - Share-alike"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/xml/" title="学习笔记｜XML 与 JSON"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">学习笔记｜XML 与 JSON</span> <span class="visible-mobile">Previous</span></a></article><article class="post-next col-6"><a href="/meaning-of-life-and-donuts/" title="人生意义与甜甜圈"><span class="hidden-mobile">人生意义与甜甜圈</span> <span class="visible-mobile">Next</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments"><div id="valine"></div><style>.v[data-class=v] .veditor{background-image:url(https://hutu0.aimtao.net/foot/drinkwater.webp);background-size:contain;background-repeat:no-repeat;background-position:right;resize:none}</style><script type="text/javascript">Fluid.utils.loadComments("#valine",(function(){Fluid.utils.createScript("https://cdn.staticfile.org/valine/1.4.18/Valine.min.js",(function(){var e=Object.assign({appId:"Lwz6D7d9XSdSYpjixPxukzhF-gzGzoHsz",appKey:"UhkN5uCsv1zxjYO6nJ7vOjpB",path:"window.location.pathname",placeholder:"本站支持评论邮件提醒功能，在上方输入邮箱，即可收到回复通知！（支持 markdown 语法）",avatar:"robohash",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!0,serverURLs:"https://valine.aimtao.net",emojiCDN:"https://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/",emojiMaps:{666:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/6c/2022_666_org.png","微笑":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e3/2018new_weixioa02_org.png","可爱":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/09/2018new_keai_org.png","太开心":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/1e/2018new_taikaixin_org.png","鼓掌":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/2018new_guzhang_org.png","嘻嘻":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/33/2018new_xixi_org.png","哈哈":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/2018new_haha_org.png","笑cry":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/4a/2018new_xiaoku_thumb.png","挤眼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/43/2018new_jiyan_org.png","馋嘴":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/2018new_chanzui_org.png","黑线":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a3/2018new_heixian_org.png","汗":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/28/2018new_han_org.png","挖鼻":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9a/2018new_wabi_thumb.png","哼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/2018new_heng_org.png","怒":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/f6/2018new_nu_org.png","委屈":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/2018new_weiqu_org.png","可怜":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/96/2018new_kelian_org.png","失望":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/aa/2018new_shiwang_org.png","悲伤":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/ee/2018new_beishang_org.png","泪":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/2018new_leimu_org.png","允悲":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/83/2018new_kuxiao_org.png","苦涩":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/2021_bitter_org.png","害羞":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c1/2018new_haixiu_org.png","污":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/10/2018new_wu_org.png","爱你":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/f6/2018new_aini_org.png","亲亲":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/2c/2018new_qinqin_org.png","抱一抱":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/2020_hug_org.png","色":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/2018new_huaxin_org.png","憧憬":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/2018new_chongjing_org.png","舔屏":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3e/2018new_tianping_org.png","哇":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3d/2022_wow_org.png","坏笑":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/4d/2018new_huaixiao_org.png","阴险":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/2018new_yinxian_org.png","笑而不语":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/2d/2018new_xiaoerbuyu_org.png","偷笑":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/2018new_touxiao_org.png","酷":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/2018new_ku_org.png","并不简单":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/aa/2018new_bingbujiandan_org.png","思考":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/30/2018new_sikao_org.png","疑问":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/b8/2018new_ningwen_org.png","费解":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/2a/2018new_wenhao_org.png","晕":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/07/2018new_yun_org.png","衰":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a2/2018new_shuai_org.png","骷髅":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a1/2018new_kulou_org.png","嘘":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/b0/2018new_xu_org.png","闭嘴":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/2018new_bizui_org.png","傻眼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/2018new_shayan_org.png","裂开":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/202011_liekai_org.png","感冒":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/2022_cold_org.png","吃惊":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/2018new_chijing_org.png","吐":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/08/2018new_tu_org.png","生病":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3b/2018new_shengbing_org.png","拜拜":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/fd/2018new_baibai_org.png","鄙视":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/da/2018new_bishi_org.png","白眼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/ef/2018new_landelini_org.png","左哼哼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/43/2018new_zuohengheng_org.png","右哼哼":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/c1/2018new_youhengheng_org.png","抓狂":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/2018new_zhuakuang_org.png","怒骂":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/87/2018new_zhouma_org.png","打脸":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/2018new_dalian_org.png","顶":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/ae/2018new_ding_org.png","互粉":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/86/2018new_hufen02_org.png","钱":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a2/2018new_qian_org.png","哈欠":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/55/2018new_dahaqian_org.png","困":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3c/2018new_kun_org.png","睡":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e2/2018new_shuijiao_thumb.png","赢牛奶":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9c/2021_yingniunai_org.png","开学季":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/72/2021_kaixueji_org.png","求饶":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/aa/moren_qiurao02_org.png","吃瓜":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/01/2018new_chigua_org.png","打call":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/39/moren_dacall02_org.png",awsl:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/moren_awsl02_org.png","彩虹屁":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/4b/2022_praise_org.png","酸":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/b3/hot_wosuanle_org.png",doge:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/a1/2018new_doge02_org.png","二哈":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/22/2018new_erha_org.png","喵喵":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/7b/2018new_miaomiao_org.png","单身狗":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/20/2021_alongdog_org.png","揣手":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/2022_chuaishou_org.png","举手":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/fd/2022_raisehand_org.png","抱抱":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/42/2018new_baobao_org.png","摊手":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/2018new_tanshou_org.png","跪了":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/75/2018new_gui_org.png","握手":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/2018new_woshou_org.png","赞":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e6/2018new_zan_org.png",good:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/8a/2018new_good_org.png","弱":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/3d/2018new_ruo_org.png","耶":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/2018new_ye_org.png","拳头":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/86/2018new_quantou_org.png",ok:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/45/2018new_ok_org.png","加油":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/9f/2018new_jiayou_org.png","作揖":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/e7/2018new_zuoyi_org.png",haha:"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/1d/2018new_hahashoushi_org.png","鲜花":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/2018new_xianhua_org.png","杰瑞":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/da/2021_jerry_org.png","汤姆":"https://face.t.sinajs.cn/t4/appstyle/expression/ext/normal/31/2021_tom_org.png","tvgif-白眼":"https://i0.hdslb.com/bfs/emote/48f75163437445665a9be80bb316e4cb252c5415.gif","tvgif-doge":"https://i0.hdslb.com/bfs/emote/302d6c88c63ed162c81a49cafe7ed2709e6fb955.gif","tvgif-坏笑":"https://i0.hdslb.com/bfs/emote/5d2572efd09aab5dde9e2a198bb3f9ac1e2a982e.gif","tvgif-难过":"https://i0.hdslb.com/bfs/emote/9c6b41008a67755410f712334c64313df5f91b3f.gif","tvgif-生气":"https://i0.hdslb.com/bfs/emote/1902a5a2df5b5c931d88c12f0feb264b1e109d0d.gif","tvgif-委屈":"https://i0.hdslb.com/bfs/emote/af5a5853edb43a8178a8cb5df707fa5e88143699.gif","tvgif-斜眼笑":"https://i0.hdslb.com/bfs/emote/c66568b471192ca1f62f6ed4384dc1b283ab7508.gif","tvgif-呆":"https://i0.hdslb.com/bfs/emote/d3fa91e4db9215eb1e20ab9da44f1214aa4bda7b.gif","tvgif-发怒":"https://i0.hdslb.com/bfs/emote/3959eb81b952e4fa8d269d98f9e3639172d84073.gif","tvgif-惊吓":"https://i0.hdslb.com/bfs/emote/13549060757fcd92b11d0657d9b3b6038f97abb6.gif","tvgif-呕吐":"https://i0.hdslb.com/bfs/emote/db58e9442aae26694af18cc1683607cca3a16763.gif","tvgif-思考":"https://i0.hdslb.com/bfs/emote/b63f9146bfd985af014f8d6d4bdb498805be48f9.gif","tvgif-微笑":"https://i0.hdslb.com/bfs/emote/b98656855d782f61cb8edc7f7fca6563ecafff7e.gif","tvgif-疑问":"https://i0.hdslb.com/bfs/emote/fce1b1a0f3b0e39a2dc16a18508dba7b91e929f4.gif","tvgif-大哭":"https://i0.hdslb.com/bfs/emote/cba61f05f3039b02a7ffc0dfcd9d7995df9fdd74.gif","tvgif-鼓掌":"https://i0.hdslb.com/bfs/emote/be106e6b265883a9f28fbe10f7b765701e2618d4.gif","tvgif-抠鼻":"https://i0.hdslb.com/bfs/emote/696d9f93e722144dc2a78aeffc569418fdf3d565.gif","tvgif-亲亲":"https://i0.hdslb.com/bfs/emote/3534ea44ab74bd20352b88c245a06c4b4c46d271.gif","tvgif-调皮":"https://i0.hdslb.com/bfs/emote/fcd967395fd14e4dd5829fa7e8a967ce23205e52.gif","tvgif-笑哭":"https://i0.hdslb.com/bfs/emote/1c2fd1e8c9dde12812f86e5d4cbddd8993d98082.gif","tvgif-晕":"https://i0.hdslb.com/bfs/emote/030040ec5c9ddc9e3d067658c4139e7314ab42f8.gif","tvgif-点赞":"https://i0.hdslb.com/bfs/emote/30ecff401245fb56bcc1cf588d1809ac1ab1607c.gif","tvgif-害羞":"https://i0.hdslb.com/bfs/emote/411a3e459e8580f5bfd9f639a408247c4b509935.gif","tvgif-睡着":"https://i0.hdslb.com/bfs/emote/3c8b5e293261287a6203597e29b3de07df4d18c6.gif","tvgif-色":"https://i0.hdslb.com/bfs/emote/a0c6d99ab0ab63b8648f5283ff72cec04b604828.gif","tvgif-吐血":"https://i0.hdslb.com/bfs/emote/e17e4539e169d14a3389ff147afea760cebe5de5.gif","tvgif-无奈":"https://i0.hdslb.com/bfs/emote/eb4cb5f07cfd177c7e6a7914316717e56d9cc1d0.gif","tvgif-再见":"https://i0.hdslb.com/bfs/emote/344f61609ecce2008520dc8a977b6169215748a9.gif","tvgif-流汗":"https://i0.hdslb.com/bfs/emote/390bccec65eaff536bd5bb2a0c5b8b0bdea47334.gif","tvgif-偷笑":"https://i0.hdslb.com/bfs/emote/7f11e6f7f63e79112b833bd41fa13a83d7cd8474.gif","tvgif-抓狂":"https://i0.hdslb.com/bfs/emote/a476b93ecd8e94ac3257323fd822f91cef212de2.gif","tvgif-黑人问号":"https://i0.hdslb.com/bfs/emote/b609adf664be33224a9923262031165ae3e34cd2.gif","tvgif-困":"https://i0.hdslb.com/bfs/emote/91c2bf34ecf842d7016c01d841db3d4074bd281f.gif","tvgif-打脸":"https://i0.hdslb.com/bfs/emote/b0fad4856e59c1240e448437da3287bb5ce547e5.gif","tvgif-闭嘴":"https://i0.hdslb.com/bfs/emote/a3fc5388b09e945be3f18fe23bfed5874a0285b7.gif","tvgif-鄙视":"https://i0.hdslb.com/bfs/emote/293b5d459e6264ecf314d20937a936fa672ccd1e.gif","tvgif-腼腆":"https://i0.hdslb.com/bfs/emote/30984e8264324f901d19bea85dada7103b695534.gif","tvgif-馋":"https://i0.hdslb.com/bfs/emote/2525c5703c594e5f0752f68db8948773caebde47.gif","tvgif-可爱":"https://i0.hdslb.com/bfs/emote/f92d20f76258bc5f33fc9d7c5e2a1d41fef19a7c.gif","tvgif-发财":"https://i0.hdslb.com/bfs/emote/76131e52c9b033681b4c896c6024d29ef7ec7ec2.gif","tvgif-生病":"https://i0.hdslb.com/bfs/emote/beb94829fe04f1a41bd6ca611e1f6ca9ca169afa.gif","tvgif-流鼻血":"https://i0.hdslb.com/bfs/emote/8ef473f74a849420da712487b2f56ecca1f695f5.gif","tvgif-尴尬":"https://i0.hdslb.com/bfs/emote/e0b84ef5ee3e5b8978e584c7c5a6550c51d15f84.gif","tvgif-大佬":"https://i0.hdslb.com/bfs/emote/14ca0c05382b8741940942b2430b7a8d55c02f7e.gif","暹罗猫小豆泥-抱大腿":"https://i0.hdslb.com/bfs/emote/1e309b348e969e7ff1c7d873352799a2005494d5.png","暹罗猫小豆泥-不要":"https://i0.hdslb.com/bfs/emote/00d5e138feb370186c4e473061b21b42f8a3ea36.png","暹罗猫小豆泥-呆滞":"https://i0.hdslb.com/bfs/emote/b6ec6210f8c7095f4a14ccf8a6ec1b60fb1aa416.png","暹罗猫小豆泥-单纯":"https://i0.hdslb.com/bfs/emote/e5cdb0d44f35f545d37cbc95ca09cdb9f79ebf48.png","暹罗猫小豆泥-好耶":"https://i0.hdslb.com/bfs/emote/5fc0be80c750a057d1c068a9a3c65c7b09a49e02.png","暹罗猫小豆泥-惊讶":"https://i0.hdslb.com/bfs/emote/d6024fd52d7e66241062c045559974e2a4c6e87f.png","暹罗猫小豆泥-哭":"https://i0.hdslb.com/bfs/emote/9153d549e425cc02eb911695fff29cb59b338da0.png","暹罗猫小豆泥-来了":"https://i0.hdslb.com/bfs/emote/d5d12b9d885346de164f30d41a10f235872aaefa.png","暹罗猫小豆泥-呸":"https://i0.hdslb.com/bfs/emote/a7f7d5a13c8d1c1ff116e7362108fb49045b4b72.png","暹罗猫小豆泥-探头":"https://i0.hdslb.com/bfs/emote/4741a1d527c52365850368b2f480d5818b23cb8f.png","暹罗猫小豆泥-舔":"https://i0.hdslb.com/bfs/emote/d071edebf8d3fbad73d773e9049eee2a0c28f1d5.png","暹罗猫小豆泥-投币":"https://i0.hdslb.com/bfs/emote/77b10ddaf24b4547e712ba8ae8f8e51ca8c38bb1.png","暹罗猫小豆泥-苦鲁西":"https://i0.hdslb.com/bfs/emote/ad3b14a2a5cf6680468222581a9964577eaca3d3.png","暹罗猫小豆泥-再见":"https://i0.hdslb.com/bfs/emote/e4c72ecf403858750b881030d650769e79017561.png","暹罗猫小豆泥-震惊":"https://i0.hdslb.com/bfs/emote/7caf9631dfb93071a843e308e5382799494d3a71.png"},enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(e),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var e="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(e),Fluid.plugins.fancyBox(e)})}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><button id="floating-toc-button" class="floating-toc-button"><i class="iconfont icon-list"></i></button><div id="floating-toc" class="floating-toc"><div class="floating-toc-header"><i class="iconfont icon-list"></i></div><div class="floating-toc-body"><ul class="floating-toc-list" id="floating-toc-list"></ul></div></div><script>document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("floating-toc-button"),e=document.getElementById("floating-toc"),n=document.getElementById("floating-toc-list"),o=!1,d=0,i=0;t.addEventListener("mousedown",(function(e){o=!0,d=e.clientX-t.offsetLeft,i=e.clientY-t.offsetTop})),document.addEventListener("mousemove",(function(e){o&&(t.style.left=e.clientX-d+"px",t.style.top=e.clientY-i+"px")})),document.addEventListener("mouseup",(function(){o=!1})),t.addEventListener("touchstart",(function(e){o=!0,d=e.touches[0].clientX-t.offsetLeft,i=e.touches[0].clientY-t.offsetTop})),document.addEventListener("touchmove",(function(e){o&&(t.style.left=e.touches[0].clientX-d+"px",t.style.top=e.touches[0].clientY-i+"px")})),document.addEventListener("touchend",(function(){o=!1})),t.addEventListener("click",(function(){e.classList.toggle("active")})),document.querySelectorAll(".markdown-body h1, .markdown-body h2, .markdown-body h3, .markdown-body h4, .markdown-body h5, .markdown-body h6").forEach((function(t){var o=parseInt(t.tagName.charAt(1)),d=document.createElement("li"),i=document.createElement("a");i.classList.add("floating-toc-link"),i.textContent=t.textContent,i.setAttribute("href","#"+t.getAttribute("id")),d.classList.add("floating-toc-list-item"),d.classList.add("level-"+o),d.appendChild(i),n.appendChild(d),i.addEventListener("click",(function(n){n.preventDefault();var o=t.getAttribute("id"),d=document.getElementById(o),i=document.getElementsByClassName("header-inner")[0];if(d&&i){var c=window.pageYOffset,a=d.offsetTop+i.offsetHeight-c,s=null;window.requestAnimationFrame((function t(e){s||(s=e);var n,o=e-s,d=Math.min(o/1e3,1),i=(n=d)<.5?2*n*n:(4-2*n)*n-1;window.scrollTo(0,c+a*i),o<1e3&&window.requestAnimationFrame(t)}))}e.classList.remove("active")}))}))}))</script><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">Search</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">Keyword</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="statistics"><span id="leancloud-site-pv-container" style="display:none"><i class="iconfont iconPV"></i> <span id="leancloud-site-pv"></span> </span><span id="leancloud-site-uv-container" style="display:none"><i class="iconfont iconUV"></i> <span id="leancloud-site-uv"></span></span></div><div class="beian"><span><i class="iconfont iconICP-13"></i> <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">鄂 ICP 备 20000502 号</a></span></div><div class="footer-content"><a href="https://www.aimtao.net/categories/Mark/" rel="nofollow noopener"><span id="aimtao">© 2025 AimTao </span></a><i class="iconfont icon-love"></i> <span id="timeDate">loading...</span> <span id="times">loading...</span><script>var now=new Date;function createtime(){var n=new Date("11/28/2018 15:28:05");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="&nbsp"+dnum+"&nbsp天",document.getElementById("times").innerHTML=hnum+"&nbsp小时&nbsp"+mnum+"&nbsp分&nbsp"+snum+"&nbsp秒"}setInterval("createtime()",250)</script></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script defer>if(!Fluid.ctx.dnt){var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?07fe5d228ae82eadee00480515f9d64b";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var o=jQuery("#board-ctn").offset().top;window.tocbot.init({tocSelector:"#toc-body",contentSelector:".markdown-body",headingSelector:CONFIG.toc.headingSelector||"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:CONFIG.toc.collapseDepth||0,scrollSmooth:!0,headingsOffset:-o}),t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))</script><script>!function(){var e=CONFIG.code_language.enable&&CONFIG.code_language.default,a=CONFIG.copy_btn;if(e||a){var i="";i+='<div class="code-widget">',i+="LANG",i+="</div>",jQuery(".markdown-body pre").each((function(){var n=jQuery(this);if(!(n.find("code.mermaid").length>0||n.find("span.line").length>0)){var t,c="";e&&(c=CONFIG.code_language.default,n[0].children.length>0&&n[0].children[0].classList.length>=2&&n.children().hasClass("hljs")?c=n[0].children[0].classList[1]:n[0].getAttribute("data-language")?c=n[0].getAttribute("data-language"):n.parent().hasClass("sourceCode")&&n[0].children.length>0&&n[0].children[0].classList.length>=2?(c=n[0].children[0].classList[1],n.parent().addClass("code-wrapper")):n.parent().hasClass("markdown-body")&&0===n[0].classList.length&&n.wrap('<div class="code-wrapper"></div>'),c=c.toUpperCase().replace("NONE",CONFIG.code_language.default)),n.append(i.replace("LANG",c).replace('code-widget">',(t=n[0],(Fluid.utils.getBackgroundLightness(t)>=0?"code-widget-light":"code-widget-dark")+(a?' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>':' code-widget">')))),a&&Fluid.utils.createScript("https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js",(function(){new window.ClipboardJS(".copy-btn",{target:function(e){for(var a=e.parentNode.childNodes,i=0;i<a.length;i++)if("CODE"===a[i].tagName)return a[i]}}).on("success",(function(e){e.clearSelection(),e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-copy","icon-success"),setTimeout((function(){e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-success","icon-copy")}),2e3)}))}))}}))}}()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var o=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),n=[];for(var i of o)n.push(".markdown-body > "+i.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(n.join(", "))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="/js/leancloud.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">Blog works best with JavaScript enabled</div></noscript></body></html>